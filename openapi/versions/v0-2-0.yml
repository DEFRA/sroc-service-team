openapi: 3.0.0
info:
  description: |
    Provides an interface for calculating charges, creating and queuing transactions, and generating transaction and customer files used to produce Environment Agency invoices.

    ## Working with the API

    The [SRoC service team](https://github.com/DEFRA/sroc-service-team) use [Postman](https://www.postman.com/) as the means to interact with the API. Check out their [docs](https://github.com/DEFRA/sroc-service-team/postman) for info on how to go about setting up your own Postman environment.

    ## Known issues

    ### Documentation

    - Any [4xx](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status) and [5xx](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status) responses are not currently covered in the documenation
    - The **Try it!** feature will not work in published versions of this spec. Access to the API is only possible via the VPN

    ### API

    - Query params are case senstive. Ensure they match what is in the spec below to avoid `422 - Unprocessable Entity` errors
    - To generate a bill run summary you need to call the 'View Billrun' endpoint. The API curently appears to error doing this for ones with a large number of transactions (8-9K or more)
  version: v0.2.0
  title: Charging Module API
  contact:
    name: SRoC Service Team
    email: alan.cruikshanks@environment-agency.gov.uk
    url: https://github.com/DEFRA/sroc-service-team
  license:
    name: Open Government Licence (OGL)
    url: http://www.nationalarchives.gov.uk/doc/open-government-licence/version/3
servers:
- description: Local
  url: http://localhost:3003
tags:
- name: admin
  description: Only the admin user can access these endpoints. They are not for use
    by client systems
- name: billrun
  description: Operations related to bill runs
- name: calculate
  description: Operations related to calculating charges
- name: customer
  description: Operations related to customer files
- name: transaction
  description: Operations related to transactions
paths:
  "/status":
    get:
      operationId: Status
      description: Confirm service is up and running
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                description: Returned by a call to status, it is an object that contains
                  a copy of the headers found in the original request
                type: object
                properties:
                  accept:
                    type: string
                    example: "*/*"
                  accept-encoding:
                    type: string
                    example: gzip, deflate, br
                  content-type:
                    type: string
                    example: application/json
                  host:
                    type: string
                    example: DEVCHABESNLB001-d027d9edf577c9e8.elb.eu-west-1.amazonaws.com
  "/v1/{regime}/billruns":
    get:
      operationId: ListBillRuns
      description: Request to view a list of bill runs for the specified regime. List
        may include both billed and unbilled bill runs. Response contains summary
        stats about each bill run. Transaction level info is not included.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billRunNumber
        in: query
        description: The five-digit bill run number of the file generated by the CM
          in which the transaction was included
        schema:
          description: The five-digit bill run number of the file generated by the
            CM in which the transaction was included
          type: integer
          minimum: 10000
          maximum: 99999
          example: 14283
      - name: status
        in: query
        description: Indicator to show the progress of a bill run towards billed status
        schema:
          description: Indicator to show the progress of a bill run towards billed
            status
          type: string
          enum:
          - billed
          - billing_not_required
          - generating_summary
          - initialised
          - pending
          example: billed
      - name: page
        in: query
        description: In large result sets use to page through them
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          example: 1
      - name: perPage
        in: query
        description: In large result sets use to control how many to return per page
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          maximum: 100
          example: 50
      - name: region
        in: query
        description: A single-digit region identifier for a transaction or customer.
        schema:
          description: A single-digit region identifier for a transaction or customer
          type: string
          enum:
          - A
          - B
          - E
          - N
          - S
          - T
          - W
          - Y
          example: A
      - name: sort
        in: query
        description: Specify a field to sort the results by
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
      - name: sortDir
        in: query
        description: Set whether results should be sorted using your selected sort
          field in ascending or descending order
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - asc
          - desc
      - name: transactionFileReference
        in: query
        description: A 10-digit reference indicating the name of the transaction file
          generated by the CM in which the transaction has been included
        schema:
          description: A 10-digit reference indicating the name of the transaction
            file generated by the CM in which the transaction has been included
          type: string
          maxLength: 10
          example: nalbi50023
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      billRuns:
                        type: array
                        items:
                          description: Represents a bill run record
                          type: object
                          properties:
                            id:
                              description: Internal ID (GUID) allocated by the CM
                                when creating a bill run.
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            billRunNumber:
                              description: The five-digit bill run number of the file
                                generated by the CM in which the transaction was included
                              type: integer
                              minimum: 10000
                              maximum: 99999
                              example: 14283
                            fileId:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              nullable: true
                            transactionFileReference:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              example: nalai50001.dat
                            transactionFileDate:
                              description: Date on which a transaction file was generated
                                by the CM
                              type: string
                              nullable: true
                              example: 10-JUN-2020
                            status:
                              description: Indicator to show the progress of a bill
                                run towards billed status
                              type: string
                              enum:
                              - billed
                              - billing_not_required
                              - generating_summary
                              - initialised
                              - pending
                              example: billed
                            approvedForBilling:
                              description: Boolean indicator to show whether or not
                                a user has confirmed that the transaction is ready
                                to be included in a transaction file
                              type: boolean
                              example: true
                            preSroc:
                              description: Boolean indicator to show whether a bill
                                run is for pre-SRoC or SRoC (where true indicates
                                pre-SRoC and false is SRoC)
                              type: boolean
                              example: true
                            creditCount:
                              type: integer
                              example: 8
                            creditValue:
                              type: integer
                              example: -3928
                            invoiceCount:
                              type: integer
                              example: 48
                            invoiceValue:
                              type: integer
                              example: 1017868
                            creditLineCount:
                              type: integer
                              example: 8
                            creditLineValue:
                              type: integer
                              example: -3928
                            debitLineCount:
                              type: integer
                              example: 58
                            debitLineValue:
                              type: integer
                              example: 1017868
                            zeroValueLineCount:
                              type: integer
                              example: 0
                            netTotal:
                              type: integer
                              example: 1013940
              example:
                pagination:
                  page: 1
                  perPage: 50
                  pageCount: 1
                  recordCount: 2
                data:
                  billRuns:
                  - id: adb3d105-43ae-4cdd-9421-d18b1d32e484
                    region: A
                    billRunNumber: 10002
                    fileId: 50001
                    transactionFileReference: nalai50001.dat
                    transactionFileDate:
                    status: billed
                    approvedForBilling: false
                    preSroc: true
                    creditCount: 8
                    creditValue: -3928
                    invoiceCount: 48
                    invoiceValue: 1017868
                    creditLineCount: 8
                    creditLineValue: -3928
                    debitLineCount: 58
                    debitLineValue: 1017868
                    zeroValueLineCount: 0
                    netTotal: 1013940
                  - id: d22ee1ab-d8d4-4e62-97b3-a64489c31c04
                    region: T
                    billRunNumber: 10002
                    fileId: 50002
                    transactionFileReference: nalti50002.dat
                    transactionFileDate:
                    status: billed
                    approvedForBilling: false
                    preSroc: true
                    creditCount: 0
                    creditValue: 0
                    invoiceCount: 1
                    invoiceValue: 656
                    creditLineCount: 0
                    creditLineValue: 0
                    debitLineCount: 1
                    debitLineValue: 656
                    zeroValueLineCount: 0
                    netTotal: 656
    post:
      operationId: CreateBillRun
      description: This endpoint triggers creation of a bill run record for a region.
        Bill run contains no transactions on creation.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  billrun:
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a bill run.
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      billRunNumber:
                        description: The five-digit bill run number of the file generated
                          by the CM in which the transaction was included
                        type: integer
                        minimum: 10000
                        maximum: 99999
                        example: 14283
              example:
                billRun:
                  id: 2bbbe459-966e-4026-b5d2-2f10867bdddd
                  billRunNumber: 10004
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                region:
                  description: A single-digit region identifier for a transaction
                    or customer
                  type: string
                  enum:
                  - A
                  - B
                  - E
                  - N
                  - S
                  - T
                  - W
                  - Y
                  example: A
            example:
              region: A
  "/v1/{regime}/billruns/{billrunId}":
    get:
      operationId: ViewBillRun
      description: Request to view a single (billed or unbilled) bill run based on
        the bill run ID. Triggers generation of summary stats, which are contained
        in the response.Request may include optional other parameters which result
        in response being narrowed down to cover a subset of transactions contained
        within the bill run. List of individual transactions is not included in the
        response.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      - name: customerReference
        in: query
        description: Customer Number of the invoicee
        schema:
          description: Customer Number of the invoicee
          type: string
          example: B19120000A
      - name: licenceNumber
        in: query
        description: The reference of the licence to which a charge / transaction
          relates
        schema:
          description: The reference of the licence to which a charge / transaction
            relates
          type: string
          maxLength: 150
          example: 7/34/16/*G/0093
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  billRun:
                    description: ''
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a bill run.
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      billRunNumber:
                        description: The five-digit bill run number of the file generated
                          by the CM in which the transaction was included
                        type: integer
                        minimum: 10000
                        maximum: 99999
                        example: 14283
                      region:
                        description: A single-digit region identifier for a transaction
                          or customer
                        type: string
                        enum:
                        - A
                        - B
                        - E
                        - N
                        - S
                        - T
                        - W
                        - Y
                        example: A
                      status:
                        description: Indicator to show the progress of a bill run
                          towards billed status
                        type: string
                        enum:
                        - billed
                        - billing_not_required
                        - generating_summary
                        - initialised
                        - pending
                        example: billed
                      approvedForBilling:
                        description: Boolean indicator to show whether or not a user
                          has confirmed that the transaction is ready to be included
                          in a transaction file
                        type: boolean
                        example: true
                      preSroc:
                        description: Boolean indicator to show whether a bill run
                          is for pre-SRoC or SRoC (where true indicates pre-SRoC and
                          false is SRoC)
                        type: boolean
                        example: true
                      summary:
                        type: object
                        properties:
                          creditNoteCount:
                            type: integer
                            example: 0
                          creditNoteValue:
                            type: integer
                            example: 0
                          invoiceCount:
                            type: integer
                            example: 2
                          invoiceValue:
                            type: integer
                            example: 4593
                          creditLineCount:
                            type: integer
                            example: 0
                          creditLineValue:
                            type: integer
                            example: 0
                          debitLineCount:
                            type: integer
                            example: 3
                          debitLineValue:
                            type: integer
                            example: 4593
                          zeroValueLineCount:
                            type: integer
                            example: 0
                          netTotal:
                            type: integer
                            example: 4593
                      customers:
                        type: array
                        items:
                          type: object
                          properties:
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            summaryByFinancialYear:
                              type: array
                              items:
                                type: object
                                properties:
                                  financialYear:
                                    description: The financial year (1 April to 31
                                      March) within which the charge period of a transaction
                                      falls
                                    type: integer
                                    minimum: 2014
                                    example: 2019
                                  creditLineCount:
                                    type: integer
                                    example: 0
                                  creditLineValue:
                                    type: integer
                                    example: 0
                                  debitLineCount:
                                    type: integer
                                    example: 2
                                  debitLineValue:
                                    type: integer
                                    example: 2500
                                  netTotal:
                                    type: integer
                                    example: 2500
                                  deminimis:
                                    description: Boolean flag to indicate whether
                                      a transaction was part of an invoice that was
                                      not included in a transaction file (i.e not
                                      charged to the customer) due to falling below
                                      the de-minimis value of £5
                                    type: boolean
                                    example: false
                                  transactions:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        id:
                                          description: Internal ID (GUID) allocated
                                            by the CM when creating a transaction,
                                            not necessarily visible to the user
                                          type: string
                                          format: uuid
                                          example: fd2ab097-3097-42bd-849e-046aa250a0d0
                                        chargeValue:
                                          description: The value of the transaction
                                            in pounds and pence, as calculated by
                                            the rules service
                                          type: number
                                          example: 929
                                        licenceNumber:
                                          description: The reference of the licence
                                            to which a charge / transaction relates
                                          type: string
                                          maxLength: 150
                                          example: 7/34/16/*G/0093
                                        minimumChargeAdjustment:
                                          description: Boolean indicator to show whether
                                            a transaction is a minimum charge transaction
                                            generated by the CM
                                          type: boolean
                                          example: false
                                        deminimis:
                                          description: Boolean flag to indicate whether
                                            a transaction was part of an invoice that
                                            was not included in a transaction file
                                            (i.e not charged to the customer) due
                                            to falling below the de-minimis value
                                            of £5
                                          type: boolean
                                          example: false
                      transactionFileReference:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        example: nalai50001.dat
                      transactionFileDate:
                        description: Estimated date of issue of the invoice.  In reality
                          this will be the date of generation of the transaction file,
                          and SSCL will over-write it with the actual invoice date
                          on receipt of the transaction file
                        type: string
                        nullable: true
                        example: 03-JUN-2020
              example:
                billRun:
                  id: fd2ab097-3097-42bd-849e-046aa250a0d0
                  billRunNumber: 10001
                  region: W
                  status: billed
                  approvedForBilling: true
                  preSroc: true
                  summary:
                    creditNoteCount: 0
                    creditNoteValue: 0
                    invoiceCount: 2
                    invoiceValue: 6686
                    creditLineCount: 0
                    creditLineValue: 0
                    debitLineCount: 4
                    debitLineValue: 6686
                    zeroValueLineCount: 1
                    netTotal: 6686
                  customers:
                  - customerReference: TH150000020
                    summaryByFinancialYear:
                    - financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroValueLineCount: 0
                      netTotal: 2500
                      deminimis: false
                      transactions:
                      - id: 5e184548-2852-4876-90b5-3a3016f4375f
                        chargeValue: 252
                        licenceNumber: TONY/TFTTT/306
                        minimumChargeAdjustment: false
                        deminimis: false
                      - id: 34dce57e-3955-4ff1-8bf7-97e443956b75
                        chargeValue: 2248
                        licenceNumber: TONY/TFTTT/306
                        minimumChargeAdjustment: true
                        deminimis: false
                  - customerReference: TH230000222
                    summaryByFinancialYear:
                    - financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 4186
                      zeroValueLineCount: 1
                      netTotal: 4186
                      deminimis: false
                      transactions:
                      - id: 26e129ec-9025-48d0-a70e-3028750b93ca
                        chargeValue: 0
                        licenceNumber: TONY/TF9222/37
                        minimumChargeAdjustment: false
                        deminimis: false
                      - id: 21926b74-db2e-457f-903b-180c14b16baf
                        chargeValue: 2093
                        licenceNumber: TONY/TF9222/37
                        minimumChargeAdjustment: false
                        deminimis: false
                      - id: eb83abf5-79dc-4717-94c1-a1e65e8f7d17
                        chargeValue: 2093
                        licenceNumber: TONY/TF9222/37
                        minimumChargeAdjustment: false
                        deminimis: false
                  transactionFileReference: nalwi50001.dat
                  transactionFileDate: 22-SEP-2020
    delete:
      operationId: DeleteBillRun
      description: Removes a specified bill run and all transactions included in the
        bill run. Bill run must be unbilled.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '204':
          description: Success
  "/v1/{regime}/billruns/{billrunId}/approve":
    patch:
      operationId: ApproveBillRun
      description: Approves all transactions in a specified bill run.  Bill run must
        be unbilled.  Must take place before bill run is sent.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '204':
          description: Success
  "/v1/{regime}/billruns/{billrunId}/unapprove":
    patch:
      operationId: UnapproveBillRun
      description: Unapproves all transactions in a specified bill run. Bill run must
        previously have been approved and must be in unbilled status.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '204':
          description: Success
  "/v1/{regime}/billruns/{billrunId}/send":
    post:
      operationId: SendBillRun
      description: Triggers (re)generation of summary statistics for the bill run
        and creation of a transaction file containing all transactions in the bill
        run.  Bill run must be unbilled and approved.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  billRun:
                    description: ''
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a bill run.
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      billRunNumber:
                        description: The five-digit bill run number of the file generated
                          by the CM in which the transaction was included
                        type: integer
                        minimum: 10000
                        maximum: 99999
                        example: 14283
                      region:
                        description: A single-digit region identifier for a transaction
                          or customer
                        type: string
                        enum:
                        - A
                        - B
                        - E
                        - N
                        - S
                        - T
                        - W
                        - Y
                        example: A
                      status:
                        description: Indicator to show the progress of a bill run
                          towards billed status
                        type: string
                        enum:
                        - billed
                        - billing_not_required
                        - generating_summary
                        - initialised
                        - pending
                        example: billed
                      approvedForBilling:
                        description: Boolean indicator to show whether or not a user
                          has confirmed that the transaction is ready to be included
                          in a transaction file
                        type: boolean
                        example: true
                      preSroc:
                        description: Boolean indicator to show whether a bill run
                          is for pre-SRoC or SRoC (where true indicates pre-SRoC and
                          false is SRoC)
                        type: boolean
                        example: true
                      summary:
                        type: object
                        properties:
                          creditNoteCount:
                            type: integer
                            example: 0
                          creditNoteValue:
                            type: integer
                            example: 0
                          invoiceCount:
                            type: integer
                            example: 2
                          invoiceValue:
                            type: integer
                            example: 4593
                          creditLineCount:
                            type: integer
                            example: 0
                          creditLineValue:
                            type: integer
                            example: 0
                          debitLineCount:
                            type: integer
                            example: 3
                          debitLineValue:
                            type: integer
                            example: 4593
                          zeroValueLineCount:
                            type: integer
                            example: 0
                          netTotal:
                            type: integer
                            example: 4593
                      customers:
                        type: array
                        items:
                          type: object
                          properties:
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            summaryByFinancialYear:
                              type: array
                              items:
                                type: object
                                properties:
                                  financialYear:
                                    description: The financial year (1 April to 31
                                      March) within which the charge period of a transaction
                                      falls
                                    type: integer
                                    minimum: 2014
                                    example: 2019
                                  creditLineCount:
                                    type: integer
                                    example: 0
                                  creditLineValue:
                                    type: integer
                                    example: 0
                                  debitLineCount:
                                    type: integer
                                    example: 2
                                  debitLineValue:
                                    type: integer
                                    example: 2500
                                  netTotal:
                                    type: integer
                                    example: 2500
                                  deminimis:
                                    description: Boolean flag to indicate whether
                                      a transaction was part of an invoice that was
                                      not included in a transaction file (i.e not
                                      charged to the customer) due to falling below
                                      the de-minimis value of £5
                                    type: boolean
                                    example: false
                                  transactions:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        id:
                                          description: Internal ID (GUID) allocated
                                            by the CM when creating a transaction,
                                            not necessarily visible to the user
                                          type: string
                                          format: uuid
                                          example: fd2ab097-3097-42bd-849e-046aa250a0d0
                                        chargeValue:
                                          description: The value of the transaction
                                            in pounds and pence, as calculated by
                                            the rules service
                                          type: number
                                          example: 929
                                        licenceNumber:
                                          description: The reference of the licence
                                            to which a charge / transaction relates
                                          type: string
                                          maxLength: 150
                                          example: 7/34/16/*G/0093
                                        minimumChargeAdjustment:
                                          description: Boolean indicator to show whether
                                            a transaction is a minimum charge transaction
                                            generated by the CM
                                          type: boolean
                                          example: false
                                        deminimis:
                                          description: Boolean flag to indicate whether
                                            a transaction was part of an invoice that
                                            was not included in a transaction file
                                            (i.e not charged to the customer) due
                                            to falling below the de-minimis value
                                            of £5
                                          type: boolean
                                          example: false
                      transactionFileReference:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        example: nalai50001.dat
                      transactionFileDate:
                        description: Estimated date of issue of the invoice.  In reality
                          this will be the date of generation of the transaction file,
                          and SSCL will over-write it with the actual invoice date
                          on receipt of the transaction file
                        type: string
                        nullable: true
                        example: 03-JUN-2020
  "/v1/{regime}/billruns/{billrunId}/transactions":
    get:
      operationId: ListBillRunTransactions
      description: Request to view all transactions meeting specified parameters and
        included in a specified (billed or unbilled) bill run.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      - name: batchNumber
        in: query
        description: Number to be generated by WRLS indicating the 'batch' in which
          creation of a transaction was requested
        schema:
          description: Number to be generated by WRLS indicating the 'batch' in which
            creation of a transaction was requested
          type: string
          nullable: true
          example: TONY100
      - name: billRunNumber
        in: query
        description: The five-digit bill run number of the file generated by the CM
          in which the transaction was included
        schema:
          description: The five-digit bill run number of the file generated by the
            CM in which the transaction was included
          type: integer
          minimum: 10000
          maximum: 99999
          example: 14283
      - name: chargeElementId
        in: query
        description: DOES NOT MATCH MASTER DATA SPECIFICATION
        schema:
          description: DOES NOT MATCH MASTER DATA SPECIFICATION
          type: string
          nullable: true
          example: '1'
      - name: customerReference
        in: query
        description: Customer Number of the invoicee
        schema:
          description: Customer Number of the invoicee
          type: string
          example: B19120000A
      - name: financialYear
        in: query
        description: The financial year (1 April to 31 March) within which the charge
          period of a transaction falls
        schema:
          description: The financial year (1 April to 31 March) within which the charge
            period of a transaction falls
          type: integer
          minimum: 2014
          example: 2019
      - name: licenceNumber
        in: query
        description: The reference of the licence to which a charge / transaction
          relates
        schema:
          description: The reference of the licence to which a charge / transaction
            relates
          type: string
          maxLength: 150
          example: 7/34/16/*G/0093
      - name: page
        in: query
        description: In large result sets use to page through them
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          example: 1
      - name: perPage
        in: query
        description: In large result sets use to control how many to return per page
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          maximum: 100
          example: 50
      - name: region
        in: query
        description: A single-digit region identifier for a transaction or customer.
        schema:
          description: A single-digit region identifier for a transaction or customer
          type: string
          enum:
          - A
          - B
          - E
          - N
          - S
          - T
          - W
          - Y
          example: A
      - name: sort
        in: query
        description: Specify a field to sort the results by
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
      - name: sortDir
        in: query
        description: Set whether results should be sorted using your selected sort
          field in ascending or descending order
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - asc
          - desc
      - name: transactionReference
        in: query
        description: A 10-digit reference which will be used as the invoice number
          on the invoice dispatched to the customer. Ref is allocated by the CM when
          adding a transaction (or set of transactions) to a transaction file for
          billing
        schema:
          description: A 10-digit reference which will be used as the invoice number
            on the invoice dispatched to the customer. Ref is allocated by the CM
            when adding a transaction (or set of transactions) to a transaction file
            for billing
          type: string
          example: BAI1273369
      - name: transactionFileReference
        in: query
        description: A 10-digit reference indicating the name of the transaction file
          generated by the CM in which the transaction has been included
        schema:
          description: A 10-digit reference indicating the name of the transaction
            file generated by the CM in which the transaction has been included
          type: string
          maxLength: 10
          example: nalbi50023
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      transactions:
                        type: array
                        items:
                          description: ''
                          type: object
                          properties:
                            id:
                              description: Internal ID (GUID) allocated by the CM
                                when creating a transaction, not necessarily visible
                                to the user
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            periodStart:
                              description: The start date of the charge period covered
                                by a transaction
                              type: string
                              example: 01-APR-2018
                            periodEnd:
                              description: The end date of the charge period covered
                                by a transaction
                              type: string
                              example: 31-MAR-2019
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            batchNumber:
                              description: Number to be generated by WRLS indicating
                                the 'batch' in which creation of a transaction was
                                requested
                              type: string
                              nullable: true
                              example: TONY100
                            invoiceDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            licenceNumber:
                              description: The reference of the licence to which a
                                charge / transaction relates
                              type: string
                              maxLength: 150
                              example: 7/34/16/*G/0093
                            chargePeriod:
                              description: The charge period for a transaction (i.e.
                                charge period start date to charge period end date)
                              type: string
                              example: 01-APR-2018 - 31-MAR-2019
                            chargeElementId:
                              description: DOES NOT MATCH MASTER DATA SPECIFICATION
                              type: string
                              nullable: true
                              example: '1'
                            billableDays:
                              description: The number of days covered by a charge
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 149
                            authorisedDays:
                              description: The number of days per year in which abstraction
                                is authorised under the terms of the licence
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 214
                            prorataDays:
                              description: Pro-rata days, shown as a fraction comprising
                                Billable Days / Authorised Days
                              type: string
                              example: 149/214
                            volume:
                              description: The volume (in thousands of cubic metres)
                                on which the charge is based
                              type: number
                              minimum: 0
                              example: 19.909
                            source:
                              description: Source on which standard charge calculation
                                based
                              type: string
                              enum:
                              - Supported
                              - Kielder
                              - Unsupported
                              - Tidal
                              example: Unsupported
                            sourceFactor:
                              description: The source factor applied to the calculation
                              type: number
                              example: 9
                            season:
                              description: Season on which charge calculation based
                              type: string
                              enum:
                              - Summer
                              - Winter
                              - All Year
                              example: Summer
                            seasonFactor:
                              description: The season factor applied to the calculation
                              type: number
                              example: 0.16
                            loss:
                              description: Loss on which charge calculation based
                              type: string
                              enum:
                              - High
                              - Medium
                              - Low
                              - Very Low
                              example: Medium
                            lossFactor:
                              description: The loss factor applied to the calculation
                              type: number
                              example: 0.003
                            section130Agreement:
                              description: Indicator to show whether a section 130
                                charge agreement applies to the transaction
                              type: boolean
                              example: true
                            licenceHolderChargeAgreement:
                              description: Summary of the Section 130 charge calculation
                                in a specific format required by the transaction file
                              type: string
                              nullable: true
                              example: S130U x 0.5
                            section126Factor:
                              description: The factor to apply to the charge where
                                a section 126 charge agreement is relevant to the
                                transaction
                              type: number
                              minimum: 0
                              maximum: 1
                              example: 0.75
                            section127Agreement:
                              description: Indicator to show whether a section 127
                                charge agreement applies to the transaction
                              type: boolean
                              example: false
                            chargeElementAgreement:
                              type: string
                            twoPartTariff:
                              description: Boolean indicator to show whether the transaction
                                is for the second part of a 2-part tariff charge
                              type: boolean
                              example: true
                            compensationCharge:
                              description: Boolean indicator to show whether the transaction
                                relates to a compensation charge
                              type: boolean
                              example: false
                            eiucSource:
                              description: Source on which compensation charge calculation
                                based
                              type: string
                              example: Tidal
                            eiucSourceFactor:
                              description: The EIUC adjusted source factor applied
                                to the calculation
                              type: number
                              example: 0.2
                            waterUndertaker:
                              description: Boolean indicator to show whether the transaction
                                is for a water undertaker
                              type: boolean
                              example: false
                            regionalChargingArea:
                              description: The name of the region relevant to the
                                determination of the SUC and / or EIUC value to be
                                used in the calculation
                              type: string
                              enum:
                              - Anglian
                              - Midlands
                              - South West
                              - North West
                              - Southern
                              - Thames
                              - Northumbria
                              - Yorkshire
                              - Wales
                              example: Northumbria
                            eiuc:
                              description: Environmental Improvement Unit Charge (EIUC)
                                for the transaction
                              type: number
                              example: 0.2
                            suc:
                              description: Standard Unit Charge (SUC) for the transaction
                              type: number
                              example: 27.51
                            chargeValue:
                              description: The value of the transaction in pounds
                                and pence, as calculated by the rules service
                              type: number
                              example: 929
                            credit:
                              description: Boolean indicator to show whether the transaction
                                is a credit (negative value)
                              type: boolean
                              example: false
                            transactionDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            areaCode:
                              description: Code identifying the historic area (within
                                a region) for the transaction.
                              type: string
                              enum:
                              - ARCA
                              - AREA
                              - ARNA
                              - CASC
                              - MIDLS
                              - MIDLT
                              - MIDUS
                              - MIDUT
                              - AACOR
                              - AADEV
                              - AANWX
                              - AASWX
                              - NWCEN
                              - NWNTH
                              - NWSTH
                              - HAAR
                              - KAEA
                              - SAAR
                              - AGY2N
                              - AGY2S
                              - AGY3
                              - AGY3N
                              - AGY3S
                              - AGY4N
                              - AGY4S
                              - N
                              - SE
                              - SE1
                              - SE2
                              - SW
                              - ABNRTH
                              - DALES
                              - NAREA
                              - RIDIN
                              - DEFAULT
                              - MULTI
                              example: NWCEN
                            lineDescription:
                              description: Description of the reason for the charge,
                                to appear on the invoice sent to the customer
                              type: string
                              maxLength: 240
                              example: Borehole at Runhall, Norfolk.
                            transactionType:
                              description: Transaction type is either 'I' for invoice
                                or 'C' for credit.  The transaction type is determined
                                by the sign (positive or negative) of the total value
                                of all lines included in a given invoice (sharing
                                the same transaction reference) within a transaction
                                file, regardless of the sign of the value of the individual
                                transaction.
                              type: string
                              enum:
                              - C
                              - I
                              nullable: true
                              example: I
                            transactionReference:
                              description: A 10-digit reference which will be used
                                as the invoice number on the invoice dispatched to
                                the customer. Ref is allocated by the CM when adding
                                a transaction (or set of transactions) to a transaction
                                file for billing
                              type: string
                              example: BAI1273369
                            billRunNumber:
                              description: The five-digit bill run number of the file
                                generated by the CM in which the transaction was included
                              type: integer
                              minimum: 10000
                              maximum: 99999
                              example: 14283
                            transactionStatus:
                              description: The current status of a transaction, e.g.
                                billed, unbilled
                              type: string
                              enum:
                              - billed
                              - unbilled
                              example: billed
                            newLicence:
                              description: Boolean indicator to show whether a transaction
                                has arisen as the result of a new licence being created
                                (note that 'new' may also incorporate licence renewals
                                or transfers of a licence to a new customer)
                              type: boolean
                              example: false
                            minimumChargeAdjustment:
                              description: Boolean indicator to show whether a transaction
                                is a minimum charge transaction generated by the CM
                              type: boolean
                              example: false
                            approvedForBilling:
                              description: Boolean indicator to show whether or not
                                a user has confirmed that the transaction is ready
                                to be included in a transaction file
                              type: boolean
                              example: true
                            deminimis:
                              description: Boolean flag to indicate whether a transaction
                                was part of an invoice that was not included in a
                                transaction file (i.e not charged to the customer)
                                due to falling below the de-minimis value of £5
                              type: boolean
                              example: false
                            transactionFileReference:
                              description: A 10-digit reference indicating the name
                                of the transaction file generated by the CM in which
                                the transaction has been included
                              type: string
                              maxLength: 10
                              example: nalbi50023
                            calculation:
                              type: object
                              properties:
                                uuid:
                                  type: string
                                  example: df6861da-9679-4733-af0b-290f25e702810
                                generatedAt:
                                  description: NOT IN MASTER DATA SPECIFICATION
                                  type: string
                                  format: datetime
                                  example: '2020-09-11T11:56:41.578Z'
                                calculation:
                                  type: object
                                  properties:
                                    chargeValue:
                                      description: The value of the transaction in
                                        pounds and pence, as calculated by the rules
                                        service
                                      type: number
                                      example: 929
                                    decisionPoints:
                                      type: object
                                      properties:
                                        sourceFactor:
                                          description: The source factor applied to
                                            the calculation
                                          type: number
                                          example: 9
                                        seasonFactor:
                                          description: The season factor applied to
                                            the calculation
                                          type: number
                                          example: 0.16
                                        lossFactor:
                                          description: The loss factor applied to
                                            the calculation
                                          type: number
                                          example: 0.003
                                        volumeFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 0.75
                                        abatementAdjustment:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s127Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s130Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        secondPartCharge:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: boolean
                                          example: false
                                        waterUndertaker:
                                          description: Boolean indicator to show whether
                                            the transaction is for a water undertaker
                                          type: boolean
                                          example: false
                                        eiucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: integer
                                          example: 0
                                        compensationCharge:
                                          description: Boolean indicator to show whether
                                            the transaction relates to a compensation
                                            charge
                                          type: boolean
                                          example: false
                                        eiucSourceFactor:
                                          description: The EIUC adjusted source factor
                                            applied to the calculation
                                          type: number
                                          example: 0.2
                                        sucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                    messages:
                                      type: array
                                      items:
                                        type: object
                                    sucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 2.97108
                                    volumeFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 0.75
                                    sourceFactor:
                                      description: The source factor applied to the
                                        calculation
                                      type: number
                                      example: 9
                                    seasonFactor:
                                      description: The season factor applied to the
                                        calculation
                                      type: number
                                      example: 0.16
                                    lossFactor:
                                      description: The loss factor applied to the
                                        calculation
                                      type: number
                                      example: 0.003
                                    abatementAdjustment:
                                      description: Summary of the Section 126 or Section
                                        127 charge calculations in a specific format
                                        required by the transaction file
                                      type: string
                                      nullable: true
                                      example: S126 x 0.8
                                    s127Agreement:
                                      description: Indicator to show whether a section
                                        127 charge agreement applies to the transaction
                                      type: boolean
                                      example: false
                                    s130Agreement:
                                      description: Indicator to show whether a section
                                        130 charge agreement applies to the transaction
                                      type: boolean
                                      example: true
                                    eiucSourceFactor:
                                      description: The EIUC adjusted source factor
                                        applied to the calculation
                                      type: number
                                      example: 0.2
                                    eiucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: integer
                                      example: 0
                                chargeValue:
                                  description: The value of the transaction in pounds
                                    and pence, as calculated by the rules service
                                  type: number
                                  example: 929
              example:
                pagination:
                  page: 1
                  perPage: 50
                  pageCount: 1
                  recordCount: 1
                data:
                  transactions:
                  - id: 0316d4d4-b3b8-4654-952b-3042b59eaeaf
                    region: T
                    periodStart: 01-APR-2019
                    periodEnd: 31-MAR-2020
                    customerReference: THVV33009
                    batchNumber: TONY6
                    invoiceDate: 17-FEB-2020
                    licenceNumber: 123/456/26/*S/0453/R01
                    chargePeriod: 01-APR-2018 - 31-MAR-2019
                    chargeElementId: ''
                    billableDays: 310
                    authorisedDays: 365
                    prorataDays: 310/365
                    volume: 3.5865
                    source: Supported
                    sourceFactor: 3
                    season: Summer
                    seasonFactor: 1.6
                    loss: Low
                    lossFactor: 0.03
                    section130Agreement: false
                    licenceHolderChargeAgreement:
                    section126Factor: 1
                    section127Agreement: false
                    chargeElementAgreement:
                    twoPartTariff: false
                    compensationCharge: false
                    eiucSource: Tidal
                    eiucSourceFactor: 0
                    waterUndertaker: false
                    regionalChargingArea: Midlands
                    eiuc: 0
                    suc: 1495
                    chargeValue: 656
                    credit: false
                    transactionDate: 17-FEB-2020
                    areaCode: ARCA
                    lineDescription: Drains within Littleport & Downham IDB
                    transactionType: I
                    transactionReference: TAI1000102
                    billRunNumber: 10002
                    transactionStatus: billed
                    newLicence: false
                    minimumChargeAdjustment: false
                    approvedForBilling: true
                    deminimis: false
                    transactionFileReference: nalti50002.dat
                    calculation:
                      uuid: b9827e43-d2bb-41c7-a886-b7bac0e4bf3b0
                      generatedAt: '2020-02-17T17:43:12.277Z'
                      calculation:
                        chargeValue: 6.56
                        decisionPoints:
                          sourceFactor: 10.7595
                          seasonFactor: 17.2152
                          lossFactor: 0.5164559999999999
                          volumeFactor: 3.5865
                          abatementAdjustment: 7.721017199999999
                          s127Agreement: 7.721017199999999
                          s130Agreement: 7.721017199999999
                          secondPartCharge: false
                          waterUndertaker: false
                          eiucFactor: 0
                          compensationCharge: false
                          eiucSourceFactor: 0
                          sucFactor: 7.721017199999999
                        messages: []
                        sucFactor: 14.95
                        volumeFactor: 3.5865
                        sourceFactor: 3
                        seasonFactor: 1.6
                        lossFactor: 0.03
                        abatementAdjustment: S126 x 1.0
                        s127Agreement:
                        s130Agreement:
                        eiucSourceFactor: 0
                        eiucFactor: 0
                      chargeValue: 656
    post:
      operationId: AddBillRunTransaction
      description: Triggers creation of a transaction and immediately adds it to the
        specified bill run.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  transaction:
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a transaction, not necessarily visible to the user
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
              example:
                transaction:
                  id: fd88e6c5-8da8-4e4f-b22f-c66554cd5bf3
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                periodStart:
                  description: The start date of the charge period covered by a transaction
                  type: string
                  example: 01-APR-2018
                periodEnd:
                  description: The end date of the charge period covered by a transaction
                  type: string
                  example: 31-MAR-2019
                credit:
                  description: Boolean indicator to show whether the transaction is
                    a credit (negative value)
                  type: boolean
                  example: false
                billableDays:
                  description: The number of days covered by a charge
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 149
                authorisedDays:
                  description: The number of days per year in which abstraction is
                    authorised under the terms of the licence
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 214
                volume:
                  description: The volume (in thousands of cubic metres) on which
                    the charge is based
                  type: number
                  minimum: 0
                  example: 19.909
                source:
                  description: Source on which standard charge calculation based
                  type: string
                  enum:
                  - Supported
                  - Kielder
                  - Unsupported
                  - Tidal
                  example: Unsupported
                season:
                  description: Season on which charge calculation based
                  type: string
                  enum:
                  - Summer
                  - Winter
                  - All Year
                  example: Summer
                loss:
                  description: Loss on which charge calculation based
                  type: string
                  enum:
                  - High
                  - Medium
                  - Low
                  - Very Low
                  example: Medium
                twoPartTariff:
                  description: Boolean indicator to show whether the transaction is
                    for the second part of a 2-part tariff charge
                  type: boolean
                  example: true
                compensationCharge:
                  description: Boolean indicator to show whether the transaction relates
                    to a compensation charge
                  type: boolean
                  example: false
                eiucSource:
                  description: Source on which compensation charge calculation based
                  type: string
                  example: Tidal
                waterUndertaker:
                  description: Boolean indicator to show whether the transaction is
                    for a water undertaker
                  type: boolean
                  example: false
                regionalChargingArea:
                  description: The name of the region relevant to the determination
                    of the SUC and / or EIUC value to be used in the calculation
                  type: string
                  enum:
                  - Anglian
                  - Midlands
                  - South West
                  - North West
                  - Southern
                  - Thames
                  - Northumbria
                  - Yorkshire
                  - Wales
                  example: Northumbria
                section127Agreement:
                  description: Indicator to show whether a section 127 charge agreement
                    applies to the transaction
                  type: boolean
                  example: false
                section130Agreement:
                  description: Indicator to show whether a section 130 charge agreement
                    applies to the transaction
                  type: boolean
                  example: true
                customerReference:
                  description: Customer Number of the invoicee
                  type: string
                  example: B19120000A
                lineDescription:
                  description: Description of the reason for the charge, to appear
                    on the invoice sent to the customer
                  type: string
                  maxLength: 240
                  example: Borehole at Runhall, Norfolk.
                licenceNumber:
                  description: The reference of the licence to which a charge / transaction
                    relates
                  type: string
                  maxLength: 150
                  example: 7/34/16/*G/0093
                chargePeriod:
                  description: The charge period for a transaction (i.e. charge period
                    start date to charge period end date)
                  type: string
                  example: 01-APR-2018 - 31-MAR-2019
                chargeElementId:
                  description: DOES NOT MATCH MASTER DATA SPECIFICATION
                  type: string
                  nullable: true
                  example: '1'
                batchNumber:
                  description: Number to be generated by WRLS indicating the 'batch'
                    in which creation of a transaction was requested
                  type: string
                  nullable: true
                  example: TONY100
                region:
                  description: A single-digit region identifier for a transaction
                    or customer
                  type: string
                  enum:
                  - A
                  - B
                  - E
                  - N
                  - S
                  - T
                  - W
                  - Y
                  example: A
                areaCode:
                  description: Code identifying the historic area (within a region)
                    for the transaction.
                  type: string
                  enum:
                  - ARCA
                  - AREA
                  - ARNA
                  - CASC
                  - MIDLS
                  - MIDLT
                  - MIDUS
                  - MIDUT
                  - AACOR
                  - AADEV
                  - AANWX
                  - AASWX
                  - NWCEN
                  - NWNTH
                  - NWSTH
                  - HAAR
                  - KAEA
                  - SAAR
                  - AGY2N
                  - AGY2S
                  - AGY3
                  - AGY3N
                  - AGY3S
                  - AGY4N
                  - AGY4S
                  - N
                  - SE
                  - SE1
                  - SE2
                  - SW
                  - ABNRTH
                  - DALES
                  - NAREA
                  - RIDIN
                  - DEFAULT
                  - MULTI
                  example: NWCEN
            example:
              periodStart: 01-APR-2019
              periodEnd: 31-MAR-2020
              credit: false
              billableDays: 310
              authorisedDays: 365
              volume: '6.22'
              source: Supported
              season: Summer
              loss: Low
              twoPartTariff: false
              compensationCharge: false
              eiucSource: Tidal
              waterUndertaker: false
              regionalChargingArea: Anglian
              section127Agreement: false
              section130Agreement: false
              customerReference: TH230000222
              lineDescription: Well at Chigley Town Hall
              licenceNumber: TONY/TF9222/37
              chargePeriod: 01-APR-2018 - 31-MAR-2019
              chargeElementId: ''
              batchNumber: TONY10
              region: W
              areaCode: ARCA
    delete:
      operationId: DeleteBillRunTransactions
      description: Removes one or many transactions from a specified bill run and
        deletes the transactions. Based on parameters, for example, all transactions
        for a customer or licence. Bill run must be unbilled.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      - name: customerReference
        in: query
        description: Customer Number of the invoicee
        schema:
          description: Customer Number of the invoicee
          type: string
          example: B19120000A
      - name: financialYear
        in: query
        description: The financial year (1 April to 31 March) within which the charge
          period of a transaction falls
        schema:
          description: The financial year (1 April to 31 March) within which the charge
            period of a transaction falls
          type: integer
          minimum: 2014
          example: 2019
      - name: licenceNumber
        in: query
        description: The reference of the licence to which a charge / transaction
          relates
        schema:
          description: The reference of the licence to which a charge / transaction
            relates
          type: string
          maxLength: 150
          example: 7/34/16/*G/0093
      responses:
        '204':
          description: Success
  "/v1/{regime}/billruns/{billrunId}/transactions/{transactionId}":
    get:
      operationId: ViewBillRunTransaction
      description: Request to view a single specified transaction included in a specified
        (billed or unbilled) bill run.
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      - name: transactionId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a transaction,
          not necessarily visible to the user
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a transaction,
            not necessarily visible to the user
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      transactions:
                        type: array
                        items:
                          description: ''
                          type: object
                          properties:
                            id:
                              description: Internal ID (GUID) allocated by the CM
                                when creating a transaction, not necessarily visible
                                to the user
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            periodStart:
                              description: The start date of the charge period covered
                                by a transaction
                              type: string
                              example: 01-APR-2018
                            periodEnd:
                              description: The end date of the charge period covered
                                by a transaction
                              type: string
                              example: 31-MAR-2019
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            batchNumber:
                              description: Number to be generated by WRLS indicating
                                the 'batch' in which creation of a transaction was
                                requested
                              type: string
                              nullable: true
                              example: TONY100
                            invoiceDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            licenceNumber:
                              description: The reference of the licence to which a
                                charge / transaction relates
                              type: string
                              maxLength: 150
                              example: 7/34/16/*G/0093
                            chargePeriod:
                              description: The charge period for a transaction (i.e.
                                charge period start date to charge period end date)
                              type: string
                              example: 01-APR-2018 - 31-MAR-2019
                            chargeElementId:
                              description: DOES NOT MATCH MASTER DATA SPECIFICATION
                              type: string
                              nullable: true
                              example: '1'
                            billableDays:
                              description: The number of days covered by a charge
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 149
                            authorisedDays:
                              description: The number of days per year in which abstraction
                                is authorised under the terms of the licence
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 214
                            prorataDays:
                              description: Pro-rata days, shown as a fraction comprising
                                Billable Days / Authorised Days
                              type: string
                              example: 149/214
                            volume:
                              description: The volume (in thousands of cubic metres)
                                on which the charge is based
                              type: number
                              minimum: 0
                              example: 19.909
                            source:
                              description: Source on which standard charge calculation
                                based
                              type: string
                              enum:
                              - Supported
                              - Kielder
                              - Unsupported
                              - Tidal
                              example: Unsupported
                            sourceFactor:
                              description: The source factor applied to the calculation
                              type: number
                              example: 9
                            season:
                              description: Season on which charge calculation based
                              type: string
                              enum:
                              - Summer
                              - Winter
                              - All Year
                              example: Summer
                            seasonFactor:
                              description: The season factor applied to the calculation
                              type: number
                              example: 0.16
                            loss:
                              description: Loss on which charge calculation based
                              type: string
                              enum:
                              - High
                              - Medium
                              - Low
                              - Very Low
                              example: Medium
                            lossFactor:
                              description: The loss factor applied to the calculation
                              type: number
                              example: 0.003
                            section130Agreement:
                              description: Indicator to show whether a section 130
                                charge agreement applies to the transaction
                              type: boolean
                              example: true
                            licenceHolderChargeAgreement:
                              description: Summary of the Section 130 charge calculation
                                in a specific format required by the transaction file
                              type: string
                              nullable: true
                              example: S130U x 0.5
                            section126Factor:
                              description: The factor to apply to the charge where
                                a section 126 charge agreement is relevant to the
                                transaction
                              type: number
                              minimum: 0
                              maximum: 1
                              example: 0.75
                            section127Agreement:
                              description: Indicator to show whether a section 127
                                charge agreement applies to the transaction
                              type: boolean
                              example: false
                            chargeElementAgreement:
                              type: string
                            twoPartTariff:
                              description: Boolean indicator to show whether the transaction
                                is for the second part of a 2-part tariff charge
                              type: boolean
                              example: true
                            compensationCharge:
                              description: Boolean indicator to show whether the transaction
                                relates to a compensation charge
                              type: boolean
                              example: false
                            eiucSource:
                              description: Source on which compensation charge calculation
                                based
                              type: string
                              example: Tidal
                            eiucSourceFactor:
                              description: The EIUC adjusted source factor applied
                                to the calculation
                              type: number
                              example: 0.2
                            waterUndertaker:
                              description: Boolean indicator to show whether the transaction
                                is for a water undertaker
                              type: boolean
                              example: false
                            regionalChargingArea:
                              description: The name of the region relevant to the
                                determination of the SUC and / or EIUC value to be
                                used in the calculation
                              type: string
                              enum:
                              - Anglian
                              - Midlands
                              - South West
                              - North West
                              - Southern
                              - Thames
                              - Northumbria
                              - Yorkshire
                              - Wales
                              example: Northumbria
                            eiuc:
                              description: Environmental Improvement Unit Charge (EIUC)
                                for the transaction
                              type: number
                              example: 0.2
                            suc:
                              description: Standard Unit Charge (SUC) for the transaction
                              type: number
                              example: 27.51
                            chargeValue:
                              description: The value of the transaction in pounds
                                and pence, as calculated by the rules service
                              type: number
                              example: 929
                            credit:
                              description: Boolean indicator to show whether the transaction
                                is a credit (negative value)
                              type: boolean
                              example: false
                            transactionDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            areaCode:
                              description: Code identifying the historic area (within
                                a region) for the transaction.
                              type: string
                              enum:
                              - ARCA
                              - AREA
                              - ARNA
                              - CASC
                              - MIDLS
                              - MIDLT
                              - MIDUS
                              - MIDUT
                              - AACOR
                              - AADEV
                              - AANWX
                              - AASWX
                              - NWCEN
                              - NWNTH
                              - NWSTH
                              - HAAR
                              - KAEA
                              - SAAR
                              - AGY2N
                              - AGY2S
                              - AGY3
                              - AGY3N
                              - AGY3S
                              - AGY4N
                              - AGY4S
                              - N
                              - SE
                              - SE1
                              - SE2
                              - SW
                              - ABNRTH
                              - DALES
                              - NAREA
                              - RIDIN
                              - DEFAULT
                              - MULTI
                              example: NWCEN
                            lineDescription:
                              description: Description of the reason for the charge,
                                to appear on the invoice sent to the customer
                              type: string
                              maxLength: 240
                              example: Borehole at Runhall, Norfolk.
                            transactionType:
                              description: Transaction type is either 'I' for invoice
                                or 'C' for credit.  The transaction type is determined
                                by the sign (positive or negative) of the total value
                                of all lines included in a given invoice (sharing
                                the same transaction reference) within a transaction
                                file, regardless of the sign of the value of the individual
                                transaction.
                              type: string
                              enum:
                              - C
                              - I
                              nullable: true
                              example: I
                            transactionReference:
                              description: A 10-digit reference which will be used
                                as the invoice number on the invoice dispatched to
                                the customer. Ref is allocated by the CM when adding
                                a transaction (or set of transactions) to a transaction
                                file for billing
                              type: string
                              example: BAI1273369
                            billRunNumber:
                              description: The five-digit bill run number of the file
                                generated by the CM in which the transaction was included
                              type: integer
                              minimum: 10000
                              maximum: 99999
                              example: 14283
                            transactionStatus:
                              description: The current status of a transaction, e.g.
                                billed, unbilled
                              type: string
                              enum:
                              - billed
                              - unbilled
                              example: billed
                            newLicence:
                              description: Boolean indicator to show whether a transaction
                                has arisen as the result of a new licence being created
                                (note that 'new' may also incorporate licence renewals
                                or transfers of a licence to a new customer)
                              type: boolean
                              example: false
                            minimumChargeAdjustment:
                              description: Boolean indicator to show whether a transaction
                                is a minimum charge transaction generated by the CM
                              type: boolean
                              example: false
                            approvedForBilling:
                              description: Boolean indicator to show whether or not
                                a user has confirmed that the transaction is ready
                                to be included in a transaction file
                              type: boolean
                              example: true
                            deminimis:
                              description: Boolean flag to indicate whether a transaction
                                was part of an invoice that was not included in a
                                transaction file (i.e not charged to the customer)
                                due to falling below the de-minimis value of £5
                              type: boolean
                              example: false
                            transactionFileReference:
                              description: A 10-digit reference indicating the name
                                of the transaction file generated by the CM in which
                                the transaction has been included
                              type: string
                              maxLength: 10
                              example: nalbi50023
                            calculation:
                              type: object
                              properties:
                                uuid:
                                  type: string
                                  example: df6861da-9679-4733-af0b-290f25e702810
                                generatedAt:
                                  description: NOT IN MASTER DATA SPECIFICATION
                                  type: string
                                  format: datetime
                                  example: '2020-09-11T11:56:41.578Z'
                                calculation:
                                  type: object
                                  properties:
                                    chargeValue:
                                      description: The value of the transaction in
                                        pounds and pence, as calculated by the rules
                                        service
                                      type: number
                                      example: 929
                                    decisionPoints:
                                      type: object
                                      properties:
                                        sourceFactor:
                                          description: The source factor applied to
                                            the calculation
                                          type: number
                                          example: 9
                                        seasonFactor:
                                          description: The season factor applied to
                                            the calculation
                                          type: number
                                          example: 0.16
                                        lossFactor:
                                          description: The loss factor applied to
                                            the calculation
                                          type: number
                                          example: 0.003
                                        volumeFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 0.75
                                        abatementAdjustment:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s127Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s130Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        secondPartCharge:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: boolean
                                          example: false
                                        waterUndertaker:
                                          description: Boolean indicator to show whether
                                            the transaction is for a water undertaker
                                          type: boolean
                                          example: false
                                        eiucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: integer
                                          example: 0
                                        compensationCharge:
                                          description: Boolean indicator to show whether
                                            the transaction relates to a compensation
                                            charge
                                          type: boolean
                                          example: false
                                        eiucSourceFactor:
                                          description: The EIUC adjusted source factor
                                            applied to the calculation
                                          type: number
                                          example: 0.2
                                        sucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                    messages:
                                      type: array
                                      items:
                                        type: object
                                    sucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 2.97108
                                    volumeFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 0.75
                                    sourceFactor:
                                      description: The source factor applied to the
                                        calculation
                                      type: number
                                      example: 9
                                    seasonFactor:
                                      description: The season factor applied to the
                                        calculation
                                      type: number
                                      example: 0.16
                                    lossFactor:
                                      description: The loss factor applied to the
                                        calculation
                                      type: number
                                      example: 0.003
                                    abatementAdjustment:
                                      description: Summary of the Section 126 or Section
                                        127 charge calculations in a specific format
                                        required by the transaction file
                                      type: string
                                      nullable: true
                                      example: S126 x 0.8
                                    s127Agreement:
                                      description: Indicator to show whether a section
                                        127 charge agreement applies to the transaction
                                      type: boolean
                                      example: false
                                    s130Agreement:
                                      description: Indicator to show whether a section
                                        130 charge agreement applies to the transaction
                                      type: boolean
                                      example: true
                                    eiucSourceFactor:
                                      description: The EIUC adjusted source factor
                                        applied to the calculation
                                      type: number
                                      example: 0.2
                                    eiucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: integer
                                      example: 0
                                chargeValue:
                                  description: The value of the transaction in pounds
                                    and pence, as calculated by the rules service
                                  type: number
                                  example: 929
              example:
                transaction:
                  id: fd88e6c5-8da8-4e4f-b22f-c66554cd5bf3
                  region: W
                  periodStart: 01-APR-2019
                  periodEnd: 31-MAR-2020
                  customerReference: TH230000222
                  batchNumber: TONY10
                  invoiceDate:
                  licenceNumber: TONY/TF9222/37
                  chargePeriod: 01-APR-2018 - 31-MAR-2019
                  chargeElementId: ''
                  billableDays: 310
                  authorisedDays: 365
                  prorataDays: 310/365
                  volume: 6.22
                  source: Supported
                  sourceFactor: 3
                  season: Summer
                  seasonFactor: 1.6
                  loss: Low
                  lossFactor: 0.03
                  section130Agreement: false
                  licenceHolderChargeAgreement:
                  section126Factor: 1
                  section127Agreement: false
                  chargeElementAgreement:
                  twoPartTariff: false
                  compensationCharge: false
                  eiucSource: Tidal
                  eiucSourceFactor: 0
                  waterUndertaker: false
                  regionalChargingArea: Anglian
                  eiuc: 0
                  suc: 2751
                  chargeValue: 2093
                  credit: false
                  transactionDate:
                  areaCode: ARCA
                  lineDescription: Well at Chigley Town Hall
                  transactionType:
                  transactionReference:
                  billRunNumber: 10007
                  transactionStatus: unbilled
                  newLicence: false
                  minimumChargeAdjustment: false
                  approvedForBilling: false
                  deminimis: false
                  transactionFileReference:
                  calculation:
                    uuid: a2140a45-f023-41cf-91e0-636c27d888760
                    generatedAt: '2020-10-01T12:59:34.433Z'
                    calculation:
                      chargeValue: 20.93
                      decisionPoints:
                        sourceFactor: 18.66
                        seasonFactor: 29.856
                        lossFactor: 0.89568
                        volumeFactor: 6.22
                        abatementAdjustment: 24.640156800000003
                        s127Agreement: 24.640156800000003
                        s130Agreement: 24.640156800000003
                        secondPartCharge: false
                        waterUndertaker: false
                        eiucFactor: 0
                        compensationCharge: false
                        eiucSourceFactor: 0
                        sucFactor: 24.640156800000003
                      messages: []
                      sucFactor: 27.51
                      volumeFactor: 6.22
                      sourceFactor: 3
                      seasonFactor: 1.6
                      lossFactor: 0.03
                      abatementAdjustment: S126 x 1.0
                      s127Agreement:
                      s130Agreement:
                      eiucSourceFactor: 0
                      eiucFactor: 0
                    chargeValue: 2093
    delete:
      operationId: DeleteBillRunTransaction
      description: Removes a specified transaction from a specified bill run and deletes
        the transaction. Transaction/bill run must be in an unbilled status
      tags:
      - billrun
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billrunId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a bill run.
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a bill
            run.
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      - name: transactionId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a transaction,
          not necessarily visible to the user
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a transaction,
            not necessarily visible to the user
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '204':
          description: Success
  "/v1/{regime}/calculate_charge":
    post:
      operationId: CalculateCharge
      description: Request to calculate a standalone charge based on a set of charge
        parameters, without creating a transaction. Input and output data is not retained
        in the CM.
      tags:
      - calculate
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  calculation:
                    description: ''
                    type: object
                    properties:
                      chargeValue:
                        description: The value of the transaction in pounds and pence,
                          as calculated by the rules service
                        type: number
                        example: 929
                      sourceFactor:
                        description: The source factor applied to the calculation
                        type: number
                        example: 9
                      seasonFactor:
                        description: The season factor applied to the calculation
                        type: number
                        example: 0.16
                      lossFactor:
                        description: The loss factor applied to the calculation
                        type: number
                        example: 0.003
                      licenceHolderChargeAgreement:
                        description: Summary of the Section 130 charge calculation
                          in a specific format required by the transaction file
                        type: string
                        nullable: true
                        example: S130U x 0.5
                      chargeElementAgreement:
                        description: Summary of the Section 126 or Section 127 charge
                          calculations in a specific format required by the transaction
                          file
                        type: string
                        nullable: true
                        example: S126 x 0.8
                      eiucSourceFactor:
                        description: The EIUC adjusted source factor applied to the
                          calculation
                        type: number
                        example: 0.2
                      eiuc:
                        description: Environmental Improvement Unit Charge (EIUC)
                          for the transaction
                        type: number
                        example: 0.2
                      suc:
                        description: Standard Unit Charge (SUC) for the transaction
                        type: number
                        example: 27.51
              example:
                calculation:
                  chargeValue: 772
                  sourceFactor: 3
                  seasonFactor: 1.6
                  lossFactor: 0.03
                  licenceHolderChargeAgreement:
                  chargeElementAgreement:
                  eiucSourceFactor: 0
                  eiuc: 0
                  suc: 1495
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                periodStart:
                  description: The start date of the charge period covered by a transaction
                  type: string
                  example: 01-APR-2018
                periodEnd:
                  description: The end date of the charge period covered by a transaction
                  type: string
                  example: 31-MAR-2019
                credit:
                  description: Boolean indicator to show whether the transaction is
                    a credit (negative value)
                  type: boolean
                  example: false
                billableDays:
                  description: The number of days covered by a charge
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 149
                authorisedDays:
                  description: The number of days per year in which abstraction is
                    authorised under the terms of the licence
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 214
                volume:
                  description: The volume (in thousands of cubic metres) on which
                    the charge is based
                  type: number
                  minimum: 0
                  example: 19.909
                source:
                  description: Source on which standard charge calculation based
                  type: string
                  enum:
                  - Supported
                  - Kielder
                  - Unsupported
                  - Tidal
                  example: Unsupported
                season:
                  description: Season on which charge calculation based
                  type: string
                  enum:
                  - Summer
                  - Winter
                  - All Year
                  example: Summer
                loss:
                  description: Loss on which charge calculation based
                  type: string
                  enum:
                  - High
                  - Medium
                  - Low
                  - Very Low
                  example: Medium
                twoPartTariff:
                  description: Boolean indicator to show whether the transaction is
                    for the second part of a 2-part tariff charge
                  type: boolean
                  example: true
                compensationCharge:
                  description: Boolean indicator to show whether the transaction relates
                    to a compensation charge
                  type: boolean
                  example: false
                eiucSource:
                  description: Source on which compensation charge calculation based
                  type: string
                  example: Tidal
                waterUndertaker:
                  description: Boolean indicator to show whether the transaction is
                    for a water undertaker
                  type: boolean
                  example: false
                regionalChargingArea:
                  description: The name of the region relevant to the determination
                    of the SUC and / or EIUC value to be used in the calculation
                  type: string
                  enum:
                  - Anglian
                  - Midlands
                  - South West
                  - North West
                  - Southern
                  - Thames
                  - Northumbria
                  - Yorkshire
                  - Wales
                  example: Northumbria
                section126Factor:
                  description: The factor to apply to the charge where a section 126
                    charge agreement is relevant to the transaction
                  type: number
                  minimum: 0
                  maximum: 1
                  example: 0.75
                section127Agreement:
                  description: Indicator to show whether a section 127 charge agreement
                    applies to the transaction
                  type: boolean
                  example: false
                section130Agreement:
                  description: Indicator to show whether a section 130 charge agreement
                    applies to the transaction
                  type: boolean
                  example: true
            example:
              periodStart: 01-APR-2020
              periodEnd: 31-MAR-2021
              credit: false
              billableDays: 214
              authorisedDays: 214
              volume: '3.5865'
              source: Supported
              season: Summer
              loss: Low
              twoPartTariff: false
              compensationCharge: false
              eiucSource: Tidal
              waterUndertaker: false
              regionalChargingArea: Midlands
              section126Factor: 1
              section127Agreement: false
              section130Agreement: false
  "/v1/{regime}/customer_files":
    get:
      operationId: ListCustomerFiles
      description: Request to view a list of all customer files meeting specified
        parameters. Returns summary info about each file and a list of customer refs
        included in each file (but no other customer data).
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: customerFileNumber
        in: query
        description: The five-digit sequential number portion of the Customer File
          Reference
        schema:
          description: The five-digit sequential number portion of the Customer File
            Reference
          type: integer
          minimum: 50001
          example: 50004
      - name: region
        in: query
        description: A single-digit region identifier for a transaction or customer.
        schema:
          description: A single-digit region identifier for a transaction or customer
          type: string
          enum:
          - A
          - B
          - E
          - N
          - S
          - T
          - W
          - Y
          example: A
      - name: page
        in: query
        description: In large result sets use to page through them
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          example: 1
      - name: perPage
        in: query
        description: In large result sets use to control how many to return per page
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          maximum: 100
          example: 50
      - name: sort
        in: query
        description: Specify a field to sort the results by
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
      - name: sortDir
        in: query
        description: Set whether results should be sorted using your selected sort
          field in ascending or descending order
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - asc
          - desc
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      customerFiles:
                        type: array
                        items:
                          description: ''
                          type: object
                          properties:
                            id:
                              description: Internal ID (GUID) allocated by the CM
                                when creating a customer file
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            file_reference:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              example: '50004'
                            status:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              example: exported
                            created_at:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              format: datetime
                              example: '2020-09-11T11:56:41.578Z'
              example:
                pagination:
                  page: 1
                  perPage: 50
                  pageCount: 1
                  recordCount: 3
                data:
                  customerFiles:
                  - id: d1b5138a-5634-48b4-8ae7-e50573d5a95c
                    region: A
                    file_reference: '50001'
                    status: exported
                    created_at: '2020-09-29T12:35:05.888Z'
                  - id: 649a1776-5d6e-44bd-9bd1-00d4612d7a2d
                    region: T
                    file_reference: '50001'
                    status: exported
                    created_at: '2020-02-17T17:15:00.799Z'
                  - id: 137892fb-4af5-4507-8da2-d149adf94b01
                    region: T
                    file_reference: '50002'
                    status: exported
                    created_at: '2020-02-17T17:43:44.903Z'
    post:
      operationId: CreateCustomerFile
      description: 'Triggers creation of a customer file for a given region, including
        all customer changes for that region that have not previously been included
        in a file. Note: This endpoint has been developed for testing purposes only
        as file generation will normally be automated in the CM rather than called
        by the source.'
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '200':
          description: Success (no action taken)
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: No customer changes found
        '201':
          description: Success (created)
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  id:
                    description: Internal ID (GUID) allocated by the CM when creating
                      a customer file
                    type: string
                    format: uuid
                    example: fd2ab097-3097-42bd-849e-046aa250a0d0
                  region:
                    description: A single-digit region identifier for a transaction
                      or customer
                    type: string
                    enum:
                    - A
                    - B
                    - E
                    - N
                    - S
                    - T
                    - W
                    - Y
                    example: A
                  fileName:
                    description: NOT IN MASTER DATA SPECIFICATION
                    type: string
                    example: naltc50001.dat
                  status:
                    description: NOT IN MASTER DATA SPECIFICATION
                    type: string
                    example: exported
                  createdDate:
                    description: Date on which a customer file was generated by the
                      CM
                    type: string
                    example: 10-JUN-2020
                  customerChanges:
                    type: array
                    items:
                      type: object
                      properties:
                        customerReference:
                          description: Customer Number of the invoicee
                          type: string
                          example: B19120000A
              example:
                id: a5ad120e-69e3-41fc-9688-df244c6ea41c
                region: A
                filename: nalac50002.dat
                status: Awaiting export
                createdDate: 01-OCT-2020
                customerChanges:
                - customerReference: BB02BEEB
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                region:
                  description: A single-digit region identifier for a transaction
                    or customer
                  type: string
                  enum:
                  - A
                  - B
                  - E
                  - N
                  - S
                  - T
                  - W
                  - Y
                  example: A
            example:
              region: A
  "/v1/{regime}/customer_files/{customerFileId}":
    get:
      operationId: ViewCustomerFile
      description: Request to view a single customer file based on a customer file
        ID. Returns summary info about the file and a list of customer refs included
        in the file.
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: customerFileId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a customer
          file
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a customer
            file
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  customerFile:
                    description: ''
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a customer file
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      region:
                        description: A single-digit region identifier for a transaction
                          or customer
                        type: string
                        enum:
                        - A
                        - B
                        - E
                        - N
                        - S
                        - T
                        - W
                        - Y
                        example: A
                      fileName:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        example: naltc50001.dat
                      status:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        example: exported
                      createdDate:
                        description: Date on which a customer file was generated by
                          the CM
                        type: string
                        example: 10-JUN-2020
                      customerChanges:
                        type: array
                        items:
                          type: object
                          properties:
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
              example:
                customerFile:
                  id: d1b5138a-5634-48b4-8ae7-e50573d5a95c
                  region: A
                  filename: nalac50001.dat
                  status: Exported
                  createdDate: 29-SEP-2020
                  customerChanges:
                  - customerReference: BB02BEEB
  "/v1/{regime}/customer_changes":
    get:
      operationId: ListCustomerChanges
      description: Request to view a list of all customer changes meeting specified
        parameters, that have not yet been included in a customer file and sent to
        SSCL.
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: customerReference
        in: query
        description: Customer Number of the invoicee
        schema:
          description: Customer Number of the invoicee
          type: string
          example: B19120000A
      - name: page
        in: query
        description: In large result sets use to page through them
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          example: 1
      - name: perPage
        in: query
        description: In large result sets use to control how many to return per page
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          maximum: 100
          example: 50
      - name: region
        in: query
        description: A single-digit region identifier for a transaction or customer.
        schema:
          description: A single-digit region identifier for a transaction or customer
          type: string
          enum:
          - A
          - B
          - E
          - N
          - S
          - T
          - W
          - Y
          example: A
      - name: sort
        in: query
        description: Specify a field to sort the results by
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
      - name: sortDir
        in: query
        description: Set whether results should be sorted using your selected sort
          field in ascending or descending order
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - asc
          - desc
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      customerChanges:
                        type: array
                        items:
                          description: ''
                          type: object
                          properties:
                            id:
                              description:
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            customerName:
                              description: Name of the customer as it should be displayed
                                on the invoice (or credit note)
                              type: string
                              maxLength: 240
                              example: Mr W Aston
                            addressLine1:
                              description: First line of billing address for a customer
                              type: string
                              maxLength: 240
                              example: Park Farm
                            addressLine2:
                              description: Second line of the billing address for
                                a customer
                              type: string
                              maxLength: 240
                              example: Sugar Lane
                            addressLine3:
                              description: Third line of the billing address for a
                                customer
                              type: string
                              maxLength: 240
                              nullable: true
                              example: West Waterford
                            addressLine4:
                              description: Fourth line of the billing address for
                                a customer
                              type: string
                              maxLength: 240
                              nullable: true
                              example: Angleton
                            addressLine5:
                              description: Town of the billing address for a customer
                              type: string
                              maxLength: 60
                              nullable: true
                              example: Southampton
                            addressLine6:
                              description: County of the billing address for a customer
                              type: string
                              maxLength: 60
                              nullable: true
                              example: Hampshire
                            postcode:
                              description: Postcode of billing address for a customer
                              type: string
                              nullable: true
                              example: SO74 3KD
              example:
                pagination:
                  page: 1
                  perPage: 50
                  pageCount: 1
                  recordCount: 1
                data:
                  customerChanges:
                  - id: 4643f6c6-dc65-4aaa-883f-f3410b7fa8c8
                    region: A
                    customerReference: BB02BEEB
                    customerName: Huge Factory Ltd
                    addressLine1: 1 Monster Lane
                    addressLine2: High Town
                    addressLine3:
                    addressLine4: Chigley
                    addressLine5:
                    addressLine6:
                    postcode:
    post:
      operationId: CreateCustomerChange
      description: Provides details of a single new customer record or a change to
        an existing customer record for inclusion in a customer file and onward transmission
        to SSCL
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  customerChange:
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          customer change record for inclusion in a customer file
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
              example:
                customerChange:
                  id: 4643f6c6-dc65-4aaa-883f-f3410b7fa8c8
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                region:
                  description: A single-digit region identifier for a transaction
                    or customer
                  type: string
                  enum:
                  - A
                  - B
                  - E
                  - N
                  - S
                  - T
                  - W
                  - Y
                  example: A
                customerReference:
                  description: Customer Number of the invoicee
                  type: string
                  example: B19120000A
                customerName:
                  description: Name of the customer as it should be displayed on the
                    invoice (or credit note)
                  type: string
                  maxLength: 240
                  example: Mr W Aston
                addressLine1:
                  description: First line of billing address for a customer
                  type: string
                  maxLength: 240
                  example: Park Farm
                addressLine2:
                  description: Second line of the billing address for a customer
                  type: string
                  maxLength: 240
                  example: Sugar Lane
                addressLine3:
                  description: Third line of the billing address for a customer
                  type: string
                  maxLength: 240
                  nullable: true
                  example: West Waterford
                addressLine4:
                  description: Fourth line of the billing address for a customer
                  type: string
                  maxLength: 240
                  nullable: true
                  example: Angleton
                addressLine5:
                  description: Town of the billing address for a customer
                  type: string
                  maxLength: 60
                  nullable: true
                  example: Southampton
                addressLine6:
                  description: County of the billing address for a customer
                  type: string
                  maxLength: 60
                  nullable: true
                  example: Hampshire
                postcode:
                  description: Postcode of billing address for a customer
                  type: string
                  nullable: true
                  example: SO74 3KD
            example:
              region: A
              customerReference: BB02BEEB
              customerName: Huge Factory Ltd
              addressLine1: 1 Monster Lane
              addressLine2: High Town
              addressLine4: Chigley
  "/v1/{regime}/customer_changes/{customerChangeId}":
    get:
      operationId: ViewCustomerChange
      description: Request to view a single customer change record based on the customer
        change ID previously returned by the CM. Applies only to changes not yet included
        in a customer file (historic customer changes are not retained in the CM due
        to data protection requirements).
      tags:
      - customer
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: customerChangeId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating customer
          change record for inclusion in a customer file
        schema:
          description: Internal ID (GUID) allocated by the CM when creating customer
            change record for inclusion in a customer file
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  customerChange:
                    description: ''
                    type: object
                    properties:
                      id:
                        description:
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      region:
                        description: A single-digit region identifier for a transaction
                          or customer
                        type: string
                        enum:
                        - A
                        - B
                        - E
                        - N
                        - S
                        - T
                        - W
                        - Y
                        example: A
                      customerReference:
                        description: Customer Number of the invoicee
                        type: string
                        example: B19120000A
                      customerName:
                        description: Name of the customer as it should be displayed
                          on the invoice (or credit note)
                        type: string
                        maxLength: 240
                        example: Mr W Aston
                      addressLine1:
                        description: First line of billing address for a customer
                        type: string
                        maxLength: 240
                        example: Park Farm
                      addressLine2:
                        description: Second line of the billing address for a customer
                        type: string
                        maxLength: 240
                        example: Sugar Lane
                      addressLine3:
                        description: Third line of the billing address for a customer
                        type: string
                        maxLength: 240
                        nullable: true
                        example: West Waterford
                      addressLine4:
                        description: Fourth line of the billing address for a customer
                        type: string
                        maxLength: 240
                        nullable: true
                        example: Angleton
                      addressLine5:
                        description: Town of the billing address for a customer
                        type: string
                        maxLength: 60
                        nullable: true
                        example: Southampton
                      addressLine6:
                        description: County of the billing address for a customer
                        type: string
                        maxLength: 60
                        nullable: true
                        example: Hampshire
                      postcode:
                        description: Postcode of billing address for a customer
                        type: string
                        nullable: true
                        example: SO74 3KD
              example:
                customerChange:
                  id: 4643f6c6-dc65-4aaa-883f-f3410b7fa8c8
                  region: A
                  customerReference: BB02BEEB
                  customerName: Huge Factory Ltd
                  addressLine1: 1 Monster Lane
                  addressLine2: High Town
                  addressLine3:
                  addressLine4: Chigley
                  addressLine5:
                  addressLine6:
                  postcode:
  "/v1/{regime}/transactions":
    get:
      operationId: ListTransactions
      description: Request to view all transactions meeting specified parameters.
        List may contain both billed and unbilled transactions.
      tags:
      - transaction
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: billRunNumber
        in: query
        description: The five-digit bill run number of the file generated by the CM
          in which the transaction was included
        schema:
          description: The five-digit bill run number of the file generated by the
            CM in which the transaction was included
          type: integer
          minimum: 10000
          maximum: 99999
          example: 14283
      - name: chargeElementId
        in: query
        description: DOES NOT MATCH MASTER DATA SPECIFICATION
        schema:
          description: DOES NOT MATCH MASTER DATA SPECIFICATION
          type: string
          nullable: true
          example: '1'
      - name: customerReference
        in: query
        description: Customer Number of the invoicee
        schema:
          description: Customer Number of the invoicee
          type: string
          example: B19120000A
      - name: financialYear
        in: query
        description: The financial year (1 April to 31 March) within which the charge
          period of a transaction falls
        schema:
          description: The financial year (1 April to 31 March) within which the charge
            period of a transaction falls
          type: integer
          minimum: 2014
          example: 2019
      - name: licenceNumber
        in: query
        description: The reference of the licence to which a charge / transaction
          relates
        schema:
          description: The reference of the licence to which a charge / transaction
            relates
          type: string
          maxLength: 150
          example: 7/34/16/*G/0093
      - name: page
        in: query
        description: In large result sets use to page through them
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          example: 1
      - name: perPage
        in: query
        description: In large result sets use to control how many to return per page
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: integer
          minimum: 1
          maximum: 100
          example: 50
      - name: region
        in: query
        description: A single-digit region identifier for a transaction or customer.
        schema:
          description: A single-digit region identifier for a transaction or customer
          type: string
          enum:
          - A
          - B
          - E
          - N
          - S
          - T
          - W
          - Y
          example: A
      - name: sort
        in: query
        description: Specify a field to sort the results by
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
      - name: sortDir
        in: query
        description: Set whether results should be sorted using your selected sort
          field in ascending or descending order
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - asc
          - desc
      - name: transactionReference
        in: query
        description: A 10-digit reference which will be used as the invoice number
          on the invoice dispatched to the customer. Ref is allocated by the CM when
          adding a transaction (or set of transactions) to a transaction file for
          billing
        schema:
          description: A 10-digit reference which will be used as the invoice number
            on the invoice dispatched to the customer. Ref is allocated by the CM
            when adding a transaction (or set of transactions) to a transaction file
            for billing
          type: string
          example: BAI1273369
      - name: transactionFileReference
        in: query
        description: A 10-digit reference indicating the name of the transaction file
          generated by the CM in which the transaction has been included
        schema:
          description: A 10-digit reference indicating the name of the transaction
            file generated by the CM in which the transaction has been included
          type: string
          maxLength: 10
          example: nalbi50023
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  pagination:
                    description: Returned when a response contains multiple results
                    type: object
                    properties:
                      page:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        example: 1
                      perPage:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: integer
                        minimum: 1
                        maximum: 100
                        example: 50
                      pageCount:
                        type: integer
                        example: 1
                      recordCount:
                        type: integer
                        example: 1
                  data:
                    type: object
                    properties:
                      transactions:
                        type: array
                        items:
                          description: ''
                          type: object
                          properties:
                            id:
                              description: Internal ID (GUID) allocated by the CM
                                when creating a transaction, not necessarily visible
                                to the user
                              type: string
                              format: uuid
                              example: fd2ab097-3097-42bd-849e-046aa250a0d0
                            region:
                              description: A single-digit region identifier for a
                                transaction or customer
                              type: string
                              enum:
                              - A
                              - B
                              - E
                              - N
                              - S
                              - T
                              - W
                              - Y
                              example: A
                            periodStart:
                              description: The start date of the charge period covered
                                by a transaction
                              type: string
                              example: 01-APR-2018
                            periodEnd:
                              description: The end date of the charge period covered
                                by a transaction
                              type: string
                              example: 31-MAR-2019
                            customerReference:
                              description: Customer Number of the invoicee
                              type: string
                              example: B19120000A
                            batchNumber:
                              description: Number to be generated by WRLS indicating
                                the 'batch' in which creation of a transaction was
                                requested
                              type: string
                              nullable: true
                              example: TONY100
                            invoiceDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            licenceNumber:
                              description: The reference of the licence to which a
                                charge / transaction relates
                              type: string
                              maxLength: 150
                              example: 7/34/16/*G/0093
                            chargePeriod:
                              description: The charge period for a transaction (i.e.
                                charge period start date to charge period end date)
                              type: string
                              example: 01-APR-2018 - 31-MAR-2019
                            chargeElementId:
                              description: DOES NOT MATCH MASTER DATA SPECIFICATION
                              type: string
                              nullable: true
                              example: '1'
                            billableDays:
                              description: The number of days covered by a charge
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 149
                            authorisedDays:
                              description: The number of days per year in which abstraction
                                is authorised under the terms of the licence
                              type: integer
                              minimum: 0
                              maximum: 366
                              example: 214
                            prorataDays:
                              description: Pro-rata days, shown as a fraction comprising
                                Billable Days / Authorised Days
                              type: string
                              example: 149/214
                            volume:
                              description: The volume (in thousands of cubic metres)
                                on which the charge is based
                              type: number
                              minimum: 0
                              example: 19.909
                            source:
                              description: Source on which standard charge calculation
                                based
                              type: string
                              enum:
                              - Supported
                              - Kielder
                              - Unsupported
                              - Tidal
                              example: Unsupported
                            sourceFactor:
                              description: The source factor applied to the calculation
                              type: number
                              example: 9
                            season:
                              description: Season on which charge calculation based
                              type: string
                              enum:
                              - Summer
                              - Winter
                              - All Year
                              example: Summer
                            seasonFactor:
                              description: The season factor applied to the calculation
                              type: number
                              example: 0.16
                            loss:
                              description: Loss on which charge calculation based
                              type: string
                              enum:
                              - High
                              - Medium
                              - Low
                              - Very Low
                              example: Medium
                            lossFactor:
                              description: The loss factor applied to the calculation
                              type: number
                              example: 0.003
                            section130Agreement:
                              description: Indicator to show whether a section 130
                                charge agreement applies to the transaction
                              type: boolean
                              example: true
                            licenceHolderChargeAgreement:
                              description: Summary of the Section 130 charge calculation
                                in a specific format required by the transaction file
                              type: string
                              nullable: true
                              example: S130U x 0.5
                            section126Factor:
                              description: The factor to apply to the charge where
                                a section 126 charge agreement is relevant to the
                                transaction
                              type: number
                              minimum: 0
                              maximum: 1
                              example: 0.75
                            section127Agreement:
                              description: Indicator to show whether a section 127
                                charge agreement applies to the transaction
                              type: boolean
                              example: false
                            chargeElementAgreement:
                              type: string
                            twoPartTariff:
                              description: Boolean indicator to show whether the transaction
                                is for the second part of a 2-part tariff charge
                              type: boolean
                              example: true
                            compensationCharge:
                              description: Boolean indicator to show whether the transaction
                                relates to a compensation charge
                              type: boolean
                              example: false
                            eiucSource:
                              description: Source on which compensation charge calculation
                                based
                              type: string
                              example: Tidal
                            eiucSourceFactor:
                              description: The EIUC adjusted source factor applied
                                to the calculation
                              type: number
                              example: 0.2
                            waterUndertaker:
                              description: Boolean indicator to show whether the transaction
                                is for a water undertaker
                              type: boolean
                              example: false
                            regionalChargingArea:
                              description: The name of the region relevant to the
                                determination of the SUC and / or EIUC value to be
                                used in the calculation
                              type: string
                              enum:
                              - Anglian
                              - Midlands
                              - South West
                              - North West
                              - Southern
                              - Thames
                              - Northumbria
                              - Yorkshire
                              - Wales
                              example: Northumbria
                            eiuc:
                              description: Environmental Improvement Unit Charge (EIUC)
                                for the transaction
                              type: number
                              example: 0.2
                            suc:
                              description: Standard Unit Charge (SUC) for the transaction
                              type: number
                              example: 27.51
                            chargeValue:
                              description: The value of the transaction in pounds
                                and pence, as calculated by the rules service
                              type: number
                              example: 929
                            credit:
                              description: Boolean indicator to show whether the transaction
                                is a credit (negative value)
                              type: boolean
                              example: false
                            transactionDate:
                              description: Estimated date of issue of the invoice.  In
                                reality this will be the date of generation of the
                                transaction file, and SSCL will over-write it with
                                the actual invoice date on receipt of the transaction
                                file
                              type: string
                              nullable: true
                              example: 03-JUN-2020
                            areaCode:
                              description: Code identifying the historic area (within
                                a region) for the transaction.
                              type: string
                              enum:
                              - ARCA
                              - AREA
                              - ARNA
                              - CASC
                              - MIDLS
                              - MIDLT
                              - MIDUS
                              - MIDUT
                              - AACOR
                              - AADEV
                              - AANWX
                              - AASWX
                              - NWCEN
                              - NWNTH
                              - NWSTH
                              - HAAR
                              - KAEA
                              - SAAR
                              - AGY2N
                              - AGY2S
                              - AGY3
                              - AGY3N
                              - AGY3S
                              - AGY4N
                              - AGY4S
                              - N
                              - SE
                              - SE1
                              - SE2
                              - SW
                              - ABNRTH
                              - DALES
                              - NAREA
                              - RIDIN
                              - DEFAULT
                              - MULTI
                              example: NWCEN
                            lineDescription:
                              description: Description of the reason for the charge,
                                to appear on the invoice sent to the customer
                              type: string
                              maxLength: 240
                              example: Borehole at Runhall, Norfolk.
                            transactionType:
                              description: Transaction type is either 'I' for invoice
                                or 'C' for credit.  The transaction type is determined
                                by the sign (positive or negative) of the total value
                                of all lines included in a given invoice (sharing
                                the same transaction reference) within a transaction
                                file, regardless of the sign of the value of the individual
                                transaction.
                              type: string
                              enum:
                              - C
                              - I
                              nullable: true
                              example: I
                            transactionReference:
                              description: A 10-digit reference which will be used
                                as the invoice number on the invoice dispatched to
                                the customer. Ref is allocated by the CM when adding
                                a transaction (or set of transactions) to a transaction
                                file for billing
                              type: string
                              example: BAI1273369
                            billRunNumber:
                              description: The five-digit bill run number of the file
                                generated by the CM in which the transaction was included
                              type: integer
                              minimum: 10000
                              maximum: 99999
                              example: 14283
                            transactionStatus:
                              description: The current status of a transaction, e.g.
                                billed, unbilled
                              type: string
                              enum:
                              - billed
                              - unbilled
                              example: billed
                            newLicence:
                              description: Boolean indicator to show whether a transaction
                                has arisen as the result of a new licence being created
                                (note that 'new' may also incorporate licence renewals
                                or transfers of a licence to a new customer)
                              type: boolean
                              example: false
                            minimumChargeAdjustment:
                              description: Boolean indicator to show whether a transaction
                                is a minimum charge transaction generated by the CM
                              type: boolean
                              example: false
                            approvedForBilling:
                              description: Boolean indicator to show whether or not
                                a user has confirmed that the transaction is ready
                                to be included in a transaction file
                              type: boolean
                              example: true
                            deminimis:
                              description: Boolean flag to indicate whether a transaction
                                was part of an invoice that was not included in a
                                transaction file (i.e not charged to the customer)
                                due to falling below the de-minimis value of £5
                              type: boolean
                              example: false
                            transactionFileReference:
                              description: A 10-digit reference indicating the name
                                of the transaction file generated by the CM in which
                                the transaction has been included
                              type: string
                              maxLength: 10
                              example: nalbi50023
                            calculation:
                              type: object
                              properties:
                                uuid:
                                  type: string
                                  example: df6861da-9679-4733-af0b-290f25e702810
                                generatedAt:
                                  description: NOT IN MASTER DATA SPECIFICATION
                                  type: string
                                  format: datetime
                                  example: '2020-09-11T11:56:41.578Z'
                                calculation:
                                  type: object
                                  properties:
                                    chargeValue:
                                      description: The value of the transaction in
                                        pounds and pence, as calculated by the rules
                                        service
                                      type: number
                                      example: 929
                                    decisionPoints:
                                      type: object
                                      properties:
                                        sourceFactor:
                                          description: The source factor applied to
                                            the calculation
                                          type: number
                                          example: 9
                                        seasonFactor:
                                          description: The season factor applied to
                                            the calculation
                                          type: number
                                          example: 0.16
                                        lossFactor:
                                          description: The loss factor applied to
                                            the calculation
                                          type: number
                                          example: 0.003
                                        volumeFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 0.75
                                        abatementAdjustment:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s127Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        s130Agreement:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                        secondPartCharge:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: boolean
                                          example: false
                                        waterUndertaker:
                                          description: Boolean indicator to show whether
                                            the transaction is for a water undertaker
                                          type: boolean
                                          example: false
                                        eiucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: integer
                                          example: 0
                                        compensationCharge:
                                          description: Boolean indicator to show whether
                                            the transaction relates to a compensation
                                            charge
                                          type: boolean
                                          example: false
                                        eiucSourceFactor:
                                          description: The EIUC adjusted source factor
                                            applied to the calculation
                                          type: number
                                          example: 0.2
                                        sucFactor:
                                          description: NOT IN MASTER DATA SPECIFICATION
                                          type: number
                                          example: 2.97108
                                    messages:
                                      type: array
                                      items:
                                        type: object
                                    sucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 2.97108
                                    volumeFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: number
                                      example: 0.75
                                    sourceFactor:
                                      description: The source factor applied to the
                                        calculation
                                      type: number
                                      example: 9
                                    seasonFactor:
                                      description: The season factor applied to the
                                        calculation
                                      type: number
                                      example: 0.16
                                    lossFactor:
                                      description: The loss factor applied to the
                                        calculation
                                      type: number
                                      example: 0.003
                                    abatementAdjustment:
                                      description: Summary of the Section 126 or Section
                                        127 charge calculations in a specific format
                                        required by the transaction file
                                      type: string
                                      nullable: true
                                      example: S126 x 0.8
                                    s127Agreement:
                                      description: Indicator to show whether a section
                                        127 charge agreement applies to the transaction
                                      type: boolean
                                      example: false
                                    s130Agreement:
                                      description: Indicator to show whether a section
                                        130 charge agreement applies to the transaction
                                      type: boolean
                                      example: true
                                    eiucSourceFactor:
                                      description: The EIUC adjusted source factor
                                        applied to the calculation
                                      type: number
                                      example: 0.2
                                    eiucFactor:
                                      description: NOT IN MASTER DATA SPECIFICATION
                                      type: integer
                                      example: 0
                                chargeValue:
                                  description: The value of the transaction in pounds
                                    and pence, as calculated by the rules service
                                  type: number
                                  example: 929
    post:
      operationId: AddTransaction
      description: Creates a transaction without adding it to a bill run. Returns
        transaction ID.
      tags:
      - transaction
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                description: ''
                type: object
                properties:
                  transaction:
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a transaction, not necessarily visible to the user
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
              example:
                transaction:
                  id: e78eb69e-23ba-4436-aeb7-413fb0138806
      requestBody:
        content:
          application/json:
            schema:
              description: ''
              type: object
              properties:
                periodStart:
                  description: The start date of the charge period covered by a transaction
                  type: string
                  example: 01-APR-2018
                periodEnd:
                  description: The end date of the charge period covered by a transaction
                  type: string
                  example: 31-MAR-2019
                credit:
                  description: Boolean indicator to show whether the transaction is
                    a credit (negative value)
                  type: boolean
                  example: false
                billableDays:
                  description: The number of days covered by a charge
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 149
                authorisedDays:
                  description: The number of days per year in which abstraction is
                    authorised under the terms of the licence
                  type: integer
                  minimum: 0
                  maximum: 366
                  example: 214
                volume:
                  description: The volume (in thousands of cubic metres) on which
                    the charge is based
                  type: number
                  minimum: 0
                  example: 19.909
                source:
                  description: Source on which standard charge calculation based
                  type: string
                  enum:
                  - Supported
                  - Kielder
                  - Unsupported
                  - Tidal
                  example: Unsupported
                season:
                  description: Season on which charge calculation based
                  type: string
                  enum:
                  - Summer
                  - Winter
                  - All Year
                  example: Summer
                loss:
                  description: Loss on which charge calculation based
                  type: string
                  enum:
                  - High
                  - Medium
                  - Low
                  - Very Low
                  example: Medium
                twoPartTariff:
                  description: Boolean indicator to show whether the transaction is
                    for the second part of a 2-part tariff charge
                  type: boolean
                  example: true
                compensationCharge:
                  description: Boolean indicator to show whether the transaction relates
                    to a compensation charge
                  type: boolean
                  example: false
                eiucSource:
                  description: Source on which compensation charge calculation based
                  type: string
                  example: Tidal
                waterUndertaker:
                  description: Boolean indicator to show whether the transaction is
                    for a water undertaker
                  type: boolean
                  example: false
                regionalChargingArea:
                  description: The name of the region relevant to the determination
                    of the SUC and / or EIUC value to be used in the calculation
                  type: string
                  enum:
                  - Anglian
                  - Midlands
                  - South West
                  - North West
                  - Southern
                  - Thames
                  - Northumbria
                  - Yorkshire
                  - Wales
                  example: Northumbria
                section127Agreement:
                  description: Indicator to show whether a section 127 charge agreement
                    applies to the transaction
                  type: boolean
                  example: false
                section130Agreement:
                  description: Indicator to show whether a section 130 charge agreement
                    applies to the transaction
                  type: boolean
                  example: true
                customerReference:
                  description: Customer Number of the invoicee
                  type: string
                  example: B19120000A
                lineDescription:
                  description: Description of the reason for the charge, to appear
                    on the invoice sent to the customer
                  type: string
                  maxLength: 240
                  example: Borehole at Runhall, Norfolk.
                licenceNumber:
                  description: The reference of the licence to which a charge / transaction
                    relates
                  type: string
                  maxLength: 150
                  example: 7/34/16/*G/0093
                chargePeriod:
                  description: The charge period for a transaction (i.e. charge period
                    start date to charge period end date)
                  type: string
                  example: 01-APR-2018 - 31-MAR-2019
                chargeElementId:
                  description: DOES NOT MATCH MASTER DATA SPECIFICATION
                  type: string
                  nullable: true
                  example: '1'
                batchNumber:
                  description: Number to be generated by WRLS indicating the 'batch'
                    in which creation of a transaction was requested
                  type: string
                  nullable: true
                  example: TONY100
                region:
                  description: A single-digit region identifier for a transaction
                    or customer
                  type: string
                  enum:
                  - A
                  - B
                  - E
                  - N
                  - S
                  - T
                  - W
                  - Y
                  example: A
                areaCode:
                  description: Code identifying the historic area (within a region)
                    for the transaction.
                  type: string
                  enum:
                  - ARCA
                  - AREA
                  - ARNA
                  - CASC
                  - MIDLS
                  - MIDLT
                  - MIDUS
                  - MIDUT
                  - AACOR
                  - AADEV
                  - AANWX
                  - AASWX
                  - NWCEN
                  - NWNTH
                  - NWSTH
                  - HAAR
                  - KAEA
                  - SAAR
                  - AGY2N
                  - AGY2S
                  - AGY3
                  - AGY3N
                  - AGY3S
                  - AGY4N
                  - AGY4S
                  - N
                  - SE
                  - SE1
                  - SE2
                  - SW
                  - ABNRTH
                  - DALES
                  - NAREA
                  - RIDIN
                  - DEFAULT
                  - MULTI
                  example: NWCEN
            example:
              periodStart: 01-APR-2019
              periodEnd: 31-MAR-2020
              credit: false
              billableDays: 310
              authorisedDays: 365
              volume: '0.01'
              source: Supported
              season: Summer
              loss: Low
              twoPartTariff: false
              compensationCharge: false
              eiucSource: Tidal
              waterUndertaker: false
              regionalChargingArea: Anglian
              section127Agreement: true
              section130Agreement: false
              customerReference: THVV33009
              lineDescription: Drains within Littleport & Downham IDB
              licenceNumber: TONY/R01
              chargePeriod: 01-APR-2018 - 31-MAR-2019
              chargeElementId: ''
              batchNumber: TONY6
              region: A
              areaCode: ARCA
  "/v1/{regime}/transactions/{transactionId}":
    get:
      operationId: ViewTransaction
      description: Request to view a single transaction based on the transaction ID.
        Transaction may be billed or unbilled.
      tags:
      - transaction
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: transactionId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a transaction,
          not necessarily visible to the user
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a transaction,
            not necessarily visible to the user
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  transaction:
                    description: ''
                    type: object
                    properties:
                      id:
                        description: Internal ID (GUID) allocated by the CM when creating
                          a transaction, not necessarily visible to the user
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      region:
                        description: A single-digit region identifier for a transaction
                          or customer
                        type: string
                        enum:
                        - A
                        - B
                        - E
                        - N
                        - S
                        - T
                        - W
                        - Y
                        example: A
                      periodStart:
                        description: The start date of the charge period covered by
                          a transaction
                        type: string
                        example: 01-APR-2018
                      periodEnd:
                        description: The end date of the charge period covered by
                          a transaction
                        type: string
                        example: 31-MAR-2019
                      customerReference:
                        description: Customer Number of the invoicee
                        type: string
                        example: B19120000A
                      batchNumber:
                        description: Number to be generated by WRLS indicating the
                          'batch' in which creation of a transaction was requested
                        type: string
                        nullable: true
                        example: TONY100
                      invoiceDate:
                        description: Estimated date of issue of the invoice.  In reality
                          this will be the date of generation of the transaction file,
                          and SSCL will over-write it with the actual invoice date
                          on receipt of the transaction file
                        type: string
                        nullable: true
                        example: 03-JUN-2020
                      licenceNumber:
                        description: The reference of the licence to which a charge
                          / transaction relates
                        type: string
                        maxLength: 150
                        example: 7/34/16/*G/0093
                      chargePeriod:
                        description: The charge period for a transaction (i.e. charge
                          period start date to charge period end date)
                        type: string
                        example: 01-APR-2018 - 31-MAR-2019
                      chargeElementId:
                        description: DOES NOT MATCH MASTER DATA SPECIFICATION
                        type: string
                        nullable: true
                        example: '1'
                      billableDays:
                        description: The number of days covered by a charge
                        type: integer
                        minimum: 0
                        maximum: 366
                        example: 149
                      authorisedDays:
                        description: The number of days per year in which abstraction
                          is authorised under the terms of the licence
                        type: integer
                        minimum: 0
                        maximum: 366
                        example: 214
                      prorataDays:
                        description: Pro-rata days, shown as a fraction comprising
                          Billable Days / Authorised Days
                        type: string
                        example: 149/214
                      volume:
                        description: The volume (in thousands of cubic metres) on
                          which the charge is based
                        type: number
                        minimum: 0
                        example: 19.909
                      source:
                        description: Source on which standard charge calculation based
                        type: string
                        enum:
                        - Supported
                        - Kielder
                        - Unsupported
                        - Tidal
                        example: Unsupported
                      sourceFactor:
                        description: The source factor applied to the calculation
                        type: number
                        example: 9
                      season:
                        description: Season on which charge calculation based
                        type: string
                        enum:
                        - Summer
                        - Winter
                        - All Year
                        example: Summer
                      seasonFactor:
                        description: The season factor applied to the calculation
                        type: number
                        example: 0.16
                      loss:
                        description: Loss on which charge calculation based
                        type: string
                        enum:
                        - High
                        - Medium
                        - Low
                        - Very Low
                        example: Medium
                      lossFactor:
                        description: The loss factor applied to the calculation
                        type: number
                        example: 0.003
                      section130Agreement:
                        description: Indicator to show whether a section 130 charge
                          agreement applies to the transaction
                        type: boolean
                        example: true
                      licenceHolderChargeAgreement:
                        description: Summary of the Section 130 charge calculation
                          in a specific format required by the transaction file
                        type: string
                        nullable: true
                        example: S130U x 0.5
                      section126Factor:
                        description: The factor to apply to the charge where a section
                          126 charge agreement is relevant to the transaction
                        type: number
                        minimum: 0
                        maximum: 1
                        example: 0.75
                      section127Agreement:
                        description: Indicator to show whether a section 127 charge
                          agreement applies to the transaction
                        type: boolean
                        example: false
                      chargeElementAgreement:
                        type: string
                      twoPartTariff:
                        description: Boolean indicator to show whether the transaction
                          is for the second part of a 2-part tariff charge
                        type: boolean
                        example: true
                      compensationCharge:
                        description: Boolean indicator to show whether the transaction
                          relates to a compensation charge
                        type: boolean
                        example: false
                      eiucSource:
                        description: Source on which compensation charge calculation
                          based
                        type: string
                        example: Tidal
                      eiucSourceFactor:
                        description: The EIUC adjusted source factor applied to the
                          calculation
                        type: number
                        example: 0.2
                      waterUndertaker:
                        description: Boolean indicator to show whether the transaction
                          is for a water undertaker
                        type: boolean
                        example: false
                      regionalChargingArea:
                        description: The name of the region relevant to the determination
                          of the SUC and / or EIUC value to be used in the calculation
                        type: string
                        enum:
                        - Anglian
                        - Midlands
                        - South West
                        - North West
                        - Southern
                        - Thames
                        - Northumbria
                        - Yorkshire
                        - Wales
                        example: Northumbria
                      eiuc:
                        description: Environmental Improvement Unit Charge (EIUC)
                          for the transaction
                        type: number
                        example: 0.2
                      suc:
                        description: Standard Unit Charge (SUC) for the transaction
                        type: number
                        example: 27.51
                      chargeValue:
                        description: The value of the transaction in pounds and pence,
                          as calculated by the rules service
                        type: number
                        example: 929
                      credit:
                        description: Boolean indicator to show whether the transaction
                          is a credit (negative value)
                        type: boolean
                        example: false
                      transactionDate:
                        description: Estimated date of issue of the invoice.  In reality
                          this will be the date of generation of the transaction file,
                          and SSCL will over-write it with the actual invoice date
                          on receipt of the transaction file
                        type: string
                        nullable: true
                        example: 03-JUN-2020
                      areaCode:
                        description: Code identifying the historic area (within a
                          region) for the transaction.
                        type: string
                        enum:
                        - ARCA
                        - AREA
                        - ARNA
                        - CASC
                        - MIDLS
                        - MIDLT
                        - MIDUS
                        - MIDUT
                        - AACOR
                        - AADEV
                        - AANWX
                        - AASWX
                        - NWCEN
                        - NWNTH
                        - NWSTH
                        - HAAR
                        - KAEA
                        - SAAR
                        - AGY2N
                        - AGY2S
                        - AGY3
                        - AGY3N
                        - AGY3S
                        - AGY4N
                        - AGY4S
                        - N
                        - SE
                        - SE1
                        - SE2
                        - SW
                        - ABNRTH
                        - DALES
                        - NAREA
                        - RIDIN
                        - DEFAULT
                        - MULTI
                        example: NWCEN
                      lineDescription:
                        description: Description of the reason for the charge, to
                          appear on the invoice sent to the customer
                        type: string
                        maxLength: 240
                        example: Borehole at Runhall, Norfolk.
                      transactionType:
                        description: Transaction type is either 'I' for invoice or
                          'C' for credit.  The transaction type is determined by the
                          sign (positive or negative) of the total value of all lines
                          included in a given invoice (sharing the same transaction
                          reference) within a transaction file, regardless of the
                          sign of the value of the individual transaction.
                        type: string
                        enum:
                        - C
                        - I
                        nullable: true
                        example: I
                      transactionReference:
                        description: A 10-digit reference which will be used as the
                          invoice number on the invoice dispatched to the customer.
                          Ref is allocated by the CM when adding a transaction (or
                          set of transactions) to a transaction file for billing
                        type: string
                        example: BAI1273369
                      billRunNumber:
                        description: The five-digit bill run number of the file generated
                          by the CM in which the transaction was included
                        type: integer
                        minimum: 10000
                        maximum: 99999
                        example: 14283
                      transactionStatus:
                        description: The current status of a transaction, e.g. billed,
                          unbilled
                        type: string
                        enum:
                        - billed
                        - unbilled
                        example: billed
                      newLicence:
                        description: Boolean indicator to show whether a transaction
                          has arisen as the result of a new licence being created
                          (note that 'new' may also incorporate licence renewals or
                          transfers of a licence to a new customer)
                        type: boolean
                        example: false
                      minimumChargeAdjustment:
                        description: Boolean indicator to show whether a transaction
                          is a minimum charge transaction generated by the CM
                        type: boolean
                        example: false
                      approvedForBilling:
                        description: Boolean indicator to show whether or not a user
                          has confirmed that the transaction is ready to be included
                          in a transaction file
                        type: boolean
                        example: true
                      deminimis:
                        description: Boolean flag to indicate whether a transaction
                          was part of an invoice that was not included in a transaction
                          file (i.e not charged to the customer) due to falling below
                          the de-minimis value of £5
                        type: boolean
                        example: false
                      transactionFileReference:
                        description: A 10-digit reference indicating the name of the
                          transaction file generated by the CM in which the transaction
                          has been included
                        type: string
                        maxLength: 10
                        example: nalbi50023
                      calculation:
                        type: object
                        properties:
                          uuid:
                            type: string
                            example: df6861da-9679-4733-af0b-290f25e702810
                          generatedAt:
                            description: NOT IN MASTER DATA SPECIFICATION
                            type: string
                            format: datetime
                            example: '2020-09-11T11:56:41.578Z'
                          calculation:
                            type: object
                            properties:
                              chargeValue:
                                description: The value of the transaction in pounds
                                  and pence, as calculated by the rules service
                                type: number
                                example: 929
                              decisionPoints:
                                type: object
                                properties:
                                  sourceFactor:
                                    description: The source factor applied to the
                                      calculation
                                    type: number
                                    example: 9
                                  seasonFactor:
                                    description: The season factor applied to the
                                      calculation
                                    type: number
                                    example: 0.16
                                  lossFactor:
                                    description: The loss factor applied to the calculation
                                    type: number
                                    example: 0.003
                                  volumeFactor:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: number
                                    example: 0.75
                                  abatementAdjustment:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: number
                                    example: 2.97108
                                  s127Agreement:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: number
                                    example: 2.97108
                                  s130Agreement:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: number
                                    example: 2.97108
                                  secondPartCharge:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: boolean
                                    example: false
                                  waterUndertaker:
                                    description: Boolean indicator to show whether
                                      the transaction is for a water undertaker
                                    type: boolean
                                    example: false
                                  eiucFactor:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: integer
                                    example: 0
                                  compensationCharge:
                                    description: Boolean indicator to show whether
                                      the transaction relates to a compensation charge
                                    type: boolean
                                    example: false
                                  eiucSourceFactor:
                                    description: The EIUC adjusted source factor applied
                                      to the calculation
                                    type: number
                                    example: 0.2
                                  sucFactor:
                                    description: NOT IN MASTER DATA SPECIFICATION
                                    type: number
                                    example: 2.97108
                              messages:
                                type: array
                                items:
                                  type: object
                              sucFactor:
                                description: NOT IN MASTER DATA SPECIFICATION
                                type: number
                                example: 2.97108
                              volumeFactor:
                                description: NOT IN MASTER DATA SPECIFICATION
                                type: number
                                example: 0.75
                              sourceFactor:
                                description: The source factor applied to the calculation
                                type: number
                                example: 9
                              seasonFactor:
                                description: The season factor applied to the calculation
                                type: number
                                example: 0.16
                              lossFactor:
                                description: The loss factor applied to the calculation
                                type: number
                                example: 0.003
                              abatementAdjustment:
                                description: Summary of the Section 126 or Section
                                  127 charge calculations in a specific format required
                                  by the transaction file
                                type: string
                                nullable: true
                                example: S126 x 0.8
                              s127Agreement:
                                description: Indicator to show whether a section 127
                                  charge agreement applies to the transaction
                                type: boolean
                                example: false
                              s130Agreement:
                                description: Indicator to show whether a section 130
                                  charge agreement applies to the transaction
                                type: boolean
                                example: true
                              eiucSourceFactor:
                                description: The EIUC adjusted source factor applied
                                  to the calculation
                                type: number
                                example: 0.2
                              eiucFactor:
                                description: NOT IN MASTER DATA SPECIFICATION
                                type: integer
                                example: 0
                          chargeValue:
                            description: The value of the transaction in pounds and
                              pence, as calculated by the rules service
                            type: number
                            example: 929
              example:
                transaction:
                  id: e78eb69e-23ba-4436-aeb7-413fb0138806
                  region: A
                  periodStart: 01-APR-2019
                  periodEnd: 31-MAR-2020
                  customerReference: THVV33009
                  batchNumber: TONY6
                  invoiceDate:
                  licenceNumber: TONY/R01
                  chargePeriod: 01-APR-2018 - 31-MAR-2019
                  chargeElementId: ''
                  billableDays: 310
                  authorisedDays: 365
                  prorataDays: 310/365
                  volume: 0.01
                  source: Supported
                  sourceFactor: 3
                  season: Summer
                  seasonFactor: 1.6
                  loss: Low
                  lossFactor: 0.03
                  section130Agreement: false
                  licenceHolderChargeAgreement:
                  section126Factor: 1
                  section127Agreement: true
                  chargeElementAgreement: S127 x 0.5
                  twoPartTariff: false
                  compensationCharge: false
                  eiucSource: Tidal
                  eiucSourceFactor: 0
                  waterUndertaker: false
                  regionalChargingArea: Anglian
                  eiuc: 0
                  suc: 2751
                  chargeValue: 2
                  credit: false
                  transactionDate:
                  areaCode: ARCA
                  lineDescription: Drains within Littleport & Downham IDB
                  transactionType:
                  transactionReference:
                  billRunNumber:
                  transactionStatus: unbilled
                  newLicence: false
                  minimumChargeAdjustment: false
                  approvedForBilling: false
                  deminimis: false
                  transactionFileReference:
                  calculation:
                    uuid: 9e2575c2-8435-4564-a846-606ed2b1c2400
                    generatedAt: '2020-10-01T13:53:18.098Z'
                    calculation:
                      chargeValue: 0.02
                      decisionPoints:
                        sourceFactor: 0.03
                        seasonFactor: 0.048
                        lossFactor: 0.0014399999999999999
                        volumeFactor: 0.01
                        abatementAdjustment: 0.0396144
                        s127Agreement: 0.0198072
                        s130Agreement: 0.0198072
                        secondPartCharge: false
                        waterUndertaker: false
                        eiucFactor: 0
                        compensationCharge: false
                        eiucSourceFactor: 0
                        sucFactor: 0.0396144
                      messages: []
                      sucFactor: 27.51
                      volumeFactor: 0.01
                      sourceFactor: 3
                      seasonFactor: 1.6
                      lossFactor: 0.03
                      abatementAdjustment: S126 x 1.0
                      s127Agreement: S127 x 0.5
                      s130Agreement:
                      eiucSourceFactor: 0
                      eiucFactor: 0
                    chargeValue: 2
    delete:
      operationId: DeleteTransaction
      description: Removes a single transaction based on the transaction ID. Transaction
        must be unbilled.
      tags:
      - transaction
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      - name: transactionId
        in: path
        required: true
        description: Internal ID (GUID) allocated by the CM when creating a transaction,
          not necessarily visible to the user
        schema:
          description: Internal ID (GUID) allocated by the CM when creating a transaction,
            not necessarily visible to the user
          type: string
          format: uuid
          example: fd2ab097-3097-42bd-849e-046aa250a0d0
      responses:
        '204':
          description: Success
  "/v1/regimes":
    get:
      operationId: ListRegimes
      description: Request a list of the charging regimes recognised and managed by
        the service
      tags:
      - admin
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  regimes:
                    type: array
                    items:
                      description: Charging regime that will have its own charge rules
                      type: object
                      properties:
                        id:
                          description: NOT IN MASTER DATA SPECIFICATION
                          type: string
                          format: uuid
                          example: fd2ab097-3097-42bd-849e-046aa250a0d0
                        slug:
                          type: string
                          enum:
                          - cfd
                          - pas
                          - wml
                          - wrls
                          example: wrls
                        name:
                          type: string
                          example: Water Resources
                        pre_sroc_cutoff_date:
                          description: NOT IN MASTER DATA SPECIFICATION
                          type: string
                          format: datetime
                          example: '2020-09-11T11:56:41.578Z'
              example:
                regimes:
                - id: ef5ee223-2ee5-4f02-ace5-35330d9f3781
                  slug: cfd
                  name: Water Quality
                  pre_sroc_cutoff_date: '2018-04-01T00:00:00.000Z'
                - id: 6bd74eeb-6beb-41d9-be52-5934a49ecd97
                  slug: pas
                  name: Installations
                  pre_sroc_cutoff_date: '2018-04-01T00:00:00.000Z'
                - id: 458834a2-0541-4981-87f6-2c0ec9261661
                  slug: wml
                  name: Waste
                  pre_sroc_cutoff_date: '2018-04-01T00:00:00.000Z'
                - id: f1a7a3f9-dadc-43d8-9eec-7209b6a10af6
                  slug: wrls
                  name: Water Resources
                  pre_sroc_cutoff_date: '2018-04-01T00:00:00.000Z'
  "/v1/regimes/{regime}":
    get:
      operationId: ViewRegime
      description: Request to view a single regime based on a regime source
      tags:
      - admin
      parameters:
      - name: regime
        in: path
        required: true
        description: Charging regime to use
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          enum:
          - cfd
          - pas
          - wml
          - wrls
          example: wrls
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  regime:
                    description: Summary of a charging regime
                    type: object
                    properties:
                      id:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        format: uuid
                        example: fd2ab097-3097-42bd-849e-046aa250a0d0
                      name:
                        type: string
                        example: Water Resources
                      slug:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        enum:
                        - cfd
                        - pas
                        - wml
                        - wrls
                        example: wrls
              example:
                regime:
                  id: f1a7a3f9-dadc-43d8-9eec-7209b6a10af6
                  name: Water Resource
                  slug: wrls
  "/v1/authorised_systems":
    get:
      operationId: ListAuthorisedSystems
      description: Request a list of 'authorised systems'. An authorised system is
        essentially a user of the API, and this returns those users permitted to access
        it.
      tags:
      - admin
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  authorisedSystems:
                    type: array
                    items:
                      description: Essentially the user account of a system authorised
                        to use the API. The summarised version does not include what
                        authorisations each account has.
                      type: object
                      properties:
                        id:
                          description: NOT IN MASTER DATA SPECIFICATION
                          type: string
                          example: i7rnixijjrawj7azzhwwxxxxxx
                        name:
                          type: string
                          example: wrls
                        status:
                          type: string
                          example: active
                        created_at:
                          description: NOT IN MASTER DATA SPECIFICATION
                          type: string
                          format: datetime
                          example: '2020-09-11T11:56:41.578Z'
                        updated_at:
                          description: NOT IN MASTER DATA SPECIFICATION
                          type: string
                          format: datetime
                          example: '2020-09-11T11:56:41.578Z'
              example:
                authorisedSystems:
                - id: 1b1gshltt176v80nsc4fxxxxxx
                  name: wrls
                  status: active
                  created_at: '2020-05-01T09:19:22.065Z'
                  updated_at: '2020-05-01T09:19:22.065Z'
                - id: 710uhe3hqumsk2da43foxxxxxx
                  name: tcm
                  status: active
                  created_at: '2020-05-01T09:31:26.879Z'
                  updated_at: '2020-05-01T09:31:26.879Z'
    post:
      operationId: AddAuthorisedSystem
      description: Add a new 'authorised system'. An authorised system is essentially
        a user of the API, and this adds a new one to it.
      tags:
      - admin
      responses:
        '201':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                    example: i7rnixijjrawj7azzhwwxxxxxx
      requestBody:
        content:
          application/json:
            schema:
              description: Essentially the user account of a system authorised to
                use the API. Includes what authorisations each account has.
              type: object
              properties:
                id:
                  description: NOT IN MASTER DATA SPECIFICATION
                  type: string
                  example: i7rnixijjrawj7azzhwwxxxxxx
                name:
                  type: string
                  example: wrls
                status:
                  type: string
                  example: active
                authorisations:
                  type: array
                  items:
                    description: NOT IN MASTER DATA SPECIFICATION
                    type: string
                    enum:
                    - cfd
                    - pas
                    - wml
                    - wrls
                    example: wrls
            example:
              id: i7rnixijjrawj7azzhwwxxxxxx
              name: dashboard
              status: active
              authorisations:
              - cfd
              - pas
              - wml
              - wrls
  "/v1/authorised_systems/{authorisedSystemId}":
    get:
      operationId: ViewAuthorisedSystem
      description: Request details of an 'authorised system'. An authorised system
        is essentially a user of the API, and this returns details about it including
        which regimes it is authorised to access.
      tags:
      - admin
      parameters:
      - name: authorisedSystemId
        in: path
        required: true
        description: Client ID provided by AWS Cognito
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          example: i7rnixijjrawj7azzhwwxxxxxx
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  authorisedSystem:
                    description: Essentially the user account of a system authorised
                      to use the API. Includes what authorisations each account has.
                    type: object
                    properties:
                      id:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        example: i7rnixijjrawj7azzhwwxxxxxx
                      name:
                        type: string
                        example: wrls
                      status:
                        type: string
                        example: active
                      created_at:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        format: datetime
                        example: '2020-09-11T11:56:41.578Z'
                      updated_at:
                        description: NOT IN MASTER DATA SPECIFICATION
                        type: string
                        format: datetime
                        example: '2020-09-11T11:56:41.578Z'
                      authorisations:
                        type: array
                        items:
                          type: object
                          properties:
                            regime:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              enum:
                              - cfd
                              - pas
                              - wml
                              - wrls
                              example: wrls
                            last_accessed_at:
                              description: NOT IN MASTER DATA SPECIFICATION
                              type: string
                              format: datetime
                              example: '2020-09-11T11:56:41.578Z'
              example:
                authorisedSystem:
                  id: 1b1gshltt176v80nsc4fxxxxxx
                  name: wrls
                  status: active
                  created_at: '2020-05-01T09:19:22.065Z'
                  updated_at: '2020-05-01T09:19:22.065Z'
                  authorisations:
                  - regime: wrls
                    last_accessed_at: '2020-09-30T21:23:07.307Z'
    patch:
      operationId: UpdateAuthorisedSystem
      description: Update an 'authorised system'. An authorised system is essentially
        a user of the API, and this is used to update the details of one.
      tags:
      - admin
      parameters:
      - name: authorisedSystemId
        in: path
        required: true
        description: Client ID provided by AWS Cognito
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          example: i7rnixijjrawj7azzhwwxxxxxx
      responses:
        '204':
          description: Success
      requestBody:
        content:
          application/json:
            schema:
              description: Essentially the user account of a system authorised to
                use the API. Includes what authorisations each account has.
              type: object
              properties:
                name:
                  type: string
                  example: wrls
                status:
                  type: string
                  example: active
                authorisations:
                  type: array
                  items:
                    description: NOT IN MASTER DATA SPECIFICATION
                    type: string
                    enum:
                    - cfd
                    - pas
                    - wml
                    - wrls
                    example: wrls
            example:
              name: dashboard
              status: active
              authorisations:
              - cfd
              - pas
              - wml
              - wrls
    delete:
      operationId: DeleteAuthorisedSystem
      description: Delete an 'authorised system'. An authorised system is essentially
        a user of the API, and this is used to delete one.
      tags:
      - admin
      parameters:
      - name: authorisedSystemId
        in: path
        required: true
        description: Client ID provided by AWS Cognito
        schema:
          description: NOT IN MASTER DATA SPECIFICATION
          type: string
          example: i7rnixijjrawj7azzhwwxxxxxx
      responses:
        '204':
          description: Success
security:
- OAuth2: []
components:
  securitySchemes:
    OAuth2:
      type: oauth2
      description: The API uses [AWS Cognito](https://docs.aws.amazon.com/cognito/latest/developerguide/what-is-amazon-cognito.html)
        to manage authentication and authorisation. To use it you will first need
        a cognito client ID and password. You then use these to request a bearer token
        from AWS Cognito. The bearer token is then sent in the `Authorisation` header
        of your request
      flows:
        clientCredentials:
          tokenUrl: https://chargingmoduleapi.auth.eu-west-1.amazoncognito.com/oauth2/token
          scopes: {}
