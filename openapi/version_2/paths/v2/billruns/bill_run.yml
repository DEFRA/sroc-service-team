get:
  operationId: ViewBillRun
  description: "Request to view a single bill run based on the bill run ID."
  tags:
    - available
  parameters:
    - $ref: '../../../../schema/parameters.yml#/regime'
    - $ref: '../../../../schema/parameters.yml#/billrunId'
  responses:
    '200':
      description: "Success"
      content:
        application/json:
          examples:
            '01 Just created':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'initialised'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 0
                  invoiceValue: 0
                  netTotal: 0
                  transactionFileReference: ''
                  invoices: []
            '02 Transactions added':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'initialised'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 0
                  invoiceValue: 0
                  netTotal: 2500
                  transactionFileReference: ''
                  invoices:
                    - id: 'aa630ae0-0e51-4166-9025-66576c513f7f'
                      customerReference: 'TH150000020'
                      financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroLineCount: 0
                      deminimisInvoice: false
                      zeroValueInvoice: false
                      minimumChargeInvoice: false
                      licences:
                        - id: '3bde68ad-f55e-4a15-b1d8-c2fcd0a95fea'
                          licenceNumber: 'FOOO/BARRR/306'
                        - id: '77502697-e274-491a-bd6d-84ec557b0485'
                          licenceNumber: 'FOOO/BARRR/307'
                      netTotal: 2500
            '03 Generating bill run':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'generating'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 0
                  invoiceValue: 0
                  netTotal: 2500
                  transactionFileReference: ''
                  invoices:
                    - id: 'aa630ae0-0e51-4166-9025-66576c513f7f'
                      customerReference: 'TH150000020'
                      financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroLineCount: 0
                      deminimisInvoice: false
                      zeroValueInvoice: false
                      minimumChargeInvoice: false
                      licences:
                        - id: '3bde68ad-f55e-4a15-b1d8-c2fcd0a95fea'
                          licenceNumber: 'FOOO/BARRR/306'
                        - id: '77502697-e274-491a-bd6d-84ec557b0485'
                          licenceNumber: 'FOOO/BARRR/307'
                      netTotal: 2500
            '04 Bill run generated':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'generated'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 1
                  invoiceValue: 2500
                  netTotal: 2500
                  transactionFileReference: ''
                  invoices:
                    - id: 'aa630ae0-0e51-4166-9025-66576c513f7f'
                      customerReference: 'TH150000020'
                      financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroLineCount: 0
                      deminimisInvoice: false
                      zeroValueInvoice: false
                      minimumChargeInvoice: false
                      licences:
                        - id: '3bde68ad-f55e-4a15-b1d8-c2fcd0a95fea'
                          licenceNumber: 'FOOO/BARRR/306'
                        - id: '77502697-e274-491a-bd6d-84ec557b0485'
                          licenceNumber: 'FOOO/BARRR/307'
                      netTotal: 2500
            '05 Approved':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'approved'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 1
                  invoiceValue: 2500
                  netTotal: 2500
                  transactionFileReference: ''
                  invoices:
                    - id: 'aa630ae0-0e51-4166-9025-66576c513f7f'
                      customerReference: 'TH150000020'
                      financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroLineCount: 0
                      deminimisInvoice: false
                      zeroValueInvoice: false
                      minimumChargeInvoice: false
                      licences:
                        - id: '3bde68ad-f55e-4a15-b1d8-c2fcd0a95fea'
                          licenceNumber: 'FOOO/BARRR/306'
                        - id: '77502697-e274-491a-bd6d-84ec557b0485'
                          licenceNumber: 'FOOO/BARRR/307'
                      netTotal: 2500
            '06 Sent':
              value:
                billRun:
                  id: 'fd2ab097-3097-42bd-849e-046aa250a0d0'
                  billRunNumber: 10001
                  region: 'W'
                  status: 'pending'
                  creditNoteCount: 0
                  creditNoteValue: 0
                  invoiceCount: 1
                  invoiceValue: 2500
                  netTotal: 2500
                  transactionFileReference: 'nalwi50001'
                  invoices:
                    - id: 'aa630ae0-0e51-4166-9025-66576c513f7f'
                      customerReference: 'TH150000020'
                      financialYear: 2019
                      creditLineCount: 0
                      creditLineValue: 0
                      debitLineCount: 2
                      debitLineValue: 2500
                      zeroLineCount: 0
                      deminimisInvoice: false
                      zeroValueInvoice: false
                      minimumChargeInvoice: false
                      licences:
                        - id: '3bde68ad-f55e-4a15-b1d8-c2fcd0a95fea'
                          licenceNumber: 'FOOO/BARRR/306'
                        - id: '77502697-e274-491a-bd6d-84ec557b0485'
                          licenceNumber: 'FOOO/BARRR/307'
                      netTotal: 2500

delete:
  operationId: DeleteBillRun
  description: "Deletes a specified bill run and all invoices, licences, and transactions linked to it. Bill run must be unbilled."
  tags:
    - available
  parameters:
    - $ref: '../../../../schema/parameters.yml#/regime'
    - $ref: '../../../../schema/parameters.yml#/billrunId'
  responses:
    '204':
      description: "Success"
    '409':
      description: "Failed - the bill run is not in the right state"
      content:
        application/json:
          schema:
            example:
              statusCode: 409
              error: Conflict
              message: Bill run 212b0102-ca9c-4b41-881b-f20e7721f2c9 has a status of 'billed'.
